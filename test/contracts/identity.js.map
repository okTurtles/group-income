{
  "version": 3,
  "sources": ["../../node_modules/@sbp/sbp/dist/module.mjs", "../../frontend/common/common.js", "../../frontend/common/vSafeHtml.js", "../../frontend/model/contracts/shared/giLodash.js", "../../frontend/common/translations.js", "../../frontend/common/stringTemplate.js", "../../frontend/model/contracts/misc/flowTyper.js", "../../frontend/model/contracts/shared/validators.js", "../../frontend/model/contracts/shared/constants.js", "../../frontend/model/contracts/identity.js"],
  "sourcesContent": ["// \n\n'use strict'\n\n\nconst selectors = {}\nconst domains = {}\nconst globalFilters = []\nconst domainFilters = {}\nconst selectorFilters = {}\nconst unsafeSelectors = {}\n\nconst DOMAIN_REGEX = /^[^/]+/\n\nfunction sbp (selector, ...data) {\n  const domain = domainFromSelector(selector)\n  if (!selectors[selector]) {\n    throw new Error(`SBP: selector not registered: ${selector}`)\n  }\n  // Filters can perform additional functions, and by returning `false` they\n  // can prevent the execution of a selector. Check the most specific filters first.\n  for (const filters of [selectorFilters[selector], domainFilters[domain], globalFilters]) {\n    if (filters) {\n      for (const filter of filters) {\n        if (filter(domain, selector, data) === false) return\n      }\n    }\n  }\n  return selectors[selector].call(domains[domain].state, ...data)\n}\n\nexport function domainFromSelector (selector) {\n  const domainLookup = DOMAIN_REGEX.exec(selector)\n  if (domainLookup === null) {\n    throw new Error(`SBP: selector missing domain: ${selector}`)\n  }\n  return domainLookup[0]\n}\n\nconst SBP_BASE_SELECTORS = {\n  'sbp/selectors/register': function (sels) {\n    const registered = []\n    for (const selector in sels) {\n      const domain = domainFromSelector(selector)\n      if (selectors[selector]) {\n        (console.warn || console.log)(`[SBP WARN]: not registering already registered selector: '${selector}'`)\n      } else if (typeof sels[selector] === 'function') {\n        if (unsafeSelectors[selector]) {\n          // important warning in case we loaded any malware beforehand and aren't expecting this\n          (console.warn || console.log)(`[SBP WARN]: registering unsafe selector: '${selector}' (remember to lock after overwriting)`)\n        }\n        const fn = selectors[selector] = sels[selector]\n        registered.push(selector)\n        // ensure each domain has a domain state associated with it\n        if (!domains[domain]) {\n          domains[domain] = { state: {} }\n        }\n        // call the special _init function immediately upon registering\n        if (selector === `${domain}/_init`) {\n          fn.call(domains[domain].state)\n        }\n      }\n    }\n    return registered\n  },\n  'sbp/selectors/unregister': function (sels) {\n    for (const selector of sels) {\n      if (!unsafeSelectors[selector]) {\n        throw new Error(`SBP: can't unregister locked selector: ${selector}`)\n      }\n      delete selectors[selector]\n    }\n  },\n  'sbp/selectors/overwrite': function (sels) {\n    sbp('sbp/selectors/unregister', Object.keys(sels))\n    return sbp('sbp/selectors/register', sels)\n  },\n  'sbp/selectors/unsafe': function (sels) {\n    for (const selector of sels) {\n      if (selectors[selector]) {\n        throw new Error('unsafe must be called before registering selector')\n      }\n      unsafeSelectors[selector] = true\n    }\n  },\n  'sbp/selectors/lock': function (sels) {\n    for (const selector of sels) {\n      delete unsafeSelectors[selector]\n    }\n  },\n  'sbp/selectors/fn': function (sel) {\n    return selectors[sel]\n  },\n  'sbp/filters/global/add': function (filter) {\n    globalFilters.push(filter)\n  },\n  'sbp/filters/domain/add': function (domain, filter) {\n    if (!domainFilters[domain]) domainFilters[domain] = []\n    domainFilters[domain].push(filter)\n  },\n  'sbp/filters/selector/add': function (selector, filter) {\n    if (!selectorFilters[selector]) selectorFilters[selector] = []\n    selectorFilters[selector].push(filter)\n  }\n}\n\nSBP_BASE_SELECTORS['sbp/selectors/register'](SBP_BASE_SELECTORS)\n\nexport default sbp\n", "'use strict'\n\n// This file allows us to deduplicate some code between the main app bundle and\n// the slim'd down contract bundles.\n// Any large shared dependencies between the contracts - that are unlikely to ever\n// change - go into this file. For example, we are using Vue between the frontend\n// and the contracts (for the Vue.set/Vue.delete functions), and those are unlikely\n// to ever change in their behavior. Therefore it's a perfect candidate to go in\n// this file, resulting a smaller overall bundle for the contract slim builds.\n// All other in-project code that's shared between the contracts should be\n// placed under 'frontend/model/contracts/shared/' and imported directly\n// from both the app and the contracts. This will result in some duplicated code being\n// loaded by the contracts (even the slim'd versions) and the main app, however,\n// it will ensure the safe and consistent operation of contracts, minimizing the\n// likelihood that there will ever be a conflict between their state and what the UI\n// expects the behavior to be.\n\n// EVERYTHING EXPORTED BY THIS FILE MUST ALWAYS AND ONLY BE IMPORTED\n// VIA \"/assets/js/common.js\"!\n// DO NOT CHANGE THE BEHAVIOR OF ANYTHING IMPORTED BY THIS FILE THAT AFFECTS THE\n// BEHAVIOR OF CONTRACTS IN ANY MEANINGFUL WAY!\n// Doing otherwise defeats the purpose of this file and could lead to bugs and conflicts!\n// You may *add* behavior, but never modify or remove it.\n\nexport { default as Vue } from 'vue'\nexport { default as L } from './translations.js'\nexport * from './translations.js'\nexport * from './errors.js'\nexport * as Errors from './errors.js'\n", "/*\n * Copyright GitLab B.V.\n *\n * Permission is hereby granted, free of charge, to any person obtaining a copy of this software and associated documentation files (the \"Software\"), to deal in the Software without restriction, including without limitation the rights to use, copy, modify, merge, publish, distribute, sublicense, and/or sell copies of the Software, and to permit persons to whom the Software is furnished to do so, subject to the following conditions:\n *\n * The above copyright notice and this permission notice shall be included in all copies or substantial portions of the Software.\n *\n * THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.\n */\n\n/*\n * This file is mainly a copy of the `safe-html.js` directive found in the\n * [gitlab-ui](https://gitlab.com/gitlab-org/gitlab-ui) project,\n * slightly modifed for linting purposes and to immediately register it via\n * `Vue.directive()` rather than exporting it, consistently with our other\n * custom Vue directives.\n */\n\nimport dompurify from 'dompurify'\nimport Vue from 'vue'\nimport { cloneDeep } from '~/frontend/model/contracts/shared/giLodash.js'\n\n// See https://github.com/cure53/DOMPurify#can-i-configure-dompurify\nexport const defaultConfig = {\n  ALLOWED_ATTR: ['class'],\n  ALLOWED_TAGS: ['b', 'br', 'em', 'i', 'p', 'small', 'span', 'strong', 'sub', 'sup', 'u'],\n  // This option was in the original file.\n  RETURN_DOM_FRAGMENT: true\n}\n\nconst transform = (el, binding) => {\n  if (binding.oldValue !== binding.value) {\n    let config = defaultConfig\n    if (binding.arg === 'a') {\n      config = cloneDeep(config)\n      config.ALLOWED_ATTR.push('href', 'target')\n      config.ALLOWED_TAGS.push('a')\n    }\n    el.textContent = ''\n    el.appendChild(dompurify.sanitize(binding.value, config))\n  }\n}\n\n/*\n * Register a global custom directive called `v-safe-html`.\n *\n * Please use this instead of `v-html` everywhere user input is expected,\n *   in order to avoid XSS vulnerabilities.\n *\n * See https://github.com/okTurtles/group-income/issues/975\n */\n\nVue.directive('safe-html', {\n  bind: transform,\n  update: transform\n})\n", "// manually implemented lodash functions are better than even:\n// https://github.com/lodash/babel-plugin-lodash\n// additional tiny versions of lodash functions are available in VueScript2\n\nexport function mapValues (obj /*: Object */, fn /*: Function */, o /*: Object */ = {}) /*: any */ {\n  for (const key in obj) { o[key] = fn(obj[key]) }\n  return o\n}\n\nexport function mapObject (obj /*: Object */, fn /*: Function */) /*: {[any]: any} */ {\n  return Object.fromEntries(Object.entries(obj).map(fn))\n}\n\nexport function pick (o /*: Object */, props /*: string[] */) /*: Object */ {\n  const x = {}\n  for (const k of props) { x[k] = o[k] }\n  return x\n}\n\nexport function pickWhere (o /*: Object */, where /*: Function */) /*: Object */ {\n  const x = {}\n  for (const k in o) {\n    if (where(o[k])) { x[k] = o[k] }\n  }\n  return x\n}\n\nexport function choose (array /*: Array<*> */, indices /*: Array<number> */) /*: Array<*> */ {\n  const x = []\n  for (const idx of indices) { x.push(array[idx]) }\n  return x\n}\n\nexport function omit (o /*: Object */, props /*: string[] */) /*: {...} */ {\n  const x = {}\n  for (const k in o) {\n    if (!props.includes(k)) {\n      x[k] = o[k]\n    }\n  }\n  return x\n}\n\nexport function cloneDeep (obj /*: Object */) /*: any */ {\n  return JSON.parse(JSON.stringify(obj))\n}\n\nfunction isMergeableObject (val) {\n  const nonNullObject = val && typeof val === 'object'\n  // $FlowFixMe\n  return nonNullObject && Object.prototype.toString.call(val) !== '[object RegExp]' && Object.prototype.toString.call(val) !== '[object Date]'\n}\n\nexport function merge (obj /*: Object */, src /*: Object */) /*: any */ {\n  for (const key in src) {\n    const clone = isMergeableObject(src[key]) ? cloneDeep(src[key]) : undefined\n    if (clone && isMergeableObject(obj[key])) {\n      merge(obj[key], clone)\n      continue\n    }\n    obj[key] = clone || src[key]\n  }\n  return obj\n}\n\nexport function delay (msec /*: number */) /*: Promise<void> */ {\n  return new Promise((resolve, reject) => {\n    setTimeout(resolve, msec)\n  })\n}\n\nexport function randomBytes (length /*: number */) /*: Uint8Array */ {\n  // $FlowIssue crypto support: https://github.com/facebook/flow/issues/5019\n  return crypto.getRandomValues(new Uint8Array(length))\n}\n\nexport function randomHexString (length /*: number */) /*: string */ {\n  return Array.from(randomBytes(length), byte => (byte % 16).toString(16)).join('')\n}\n\nexport function randomIntFromRange (min /*: number */, max /*: number */) /*: number */ {\n  return Math.floor(Math.random() * (max - min + 1) + min)\n}\n\nexport function randomFromArray (arr /*: any[] */) /*: any */ {\n  return arr[Math.floor(Math.random() * arr.length)]\n}\n\nexport function flatten (arr /*: Array<*> */) /*: Array<any> */ {\n  let flat /*: Array<*> */ = []\n  for (let i = 0; i < arr.length; i++) {\n    if (Array.isArray(arr[i])) {\n      flat = flat.concat(arr[i])\n    } else {\n      flat.push(arr[i])\n    }\n  }\n  return flat\n}\n\nexport function zip () /*: any[] */ {\n  // $FlowFixMe\n  const arr = Array.prototype.slice.call(arguments)\n  const zipped = []\n  let max = 0\n  arr.forEach((current) => (max = Math.max(max, current.length)))\n  for (const current of arr) {\n    for (let i = 0; i < max; i++) {\n      zipped[i] = zipped[i] || []\n      zipped[i].push(current[i])\n    }\n  }\n  return zipped\n}\n\nexport function uniq (array /*: any[] */) /*: any[] */ {\n  return Array.from(new Set(array))\n}\n\nexport function union (...arrays /*: any[][] */) /*: any[] */ {\n  // $FlowFixMe\n  return uniq([].concat.apply([], arrays))\n}\n\nexport function intersection (a1 /*: any[] */, ...arrays /*: any[][] */) /*: any[] */ {\n  return uniq(a1).filter(v1 => arrays.every(v2 => v2.indexOf(v1) >= 0))\n}\n\nexport function difference (a1 /*: any[] */, ...arrays /*: any[][] */) /*: any[] */ {\n  // $FlowFixMe\n  const a2 = [].concat.apply([], arrays)\n  return a1.filter(v => a2.indexOf(v) === -1)\n}\n\nexport function deepEqualJSONType (a /*: any */, b /*: any */) /*: boolean */ {\n  if (a === b) return true\n  if (a === null || b === null || typeof (a) !== typeof (b)) return false\n  if (typeof a !== 'object') return a === b\n  if (Array.isArray(a)) {\n    if (a.length !== b.length) return false\n  } else if (a.constructor.name !== 'Object') {\n    throw new Error(`not JSON type: ${a}`)\n  }\n  for (const key in a) {\n    if (!deepEqualJSONType(a[key], b[key])) return false\n  }\n  return true\n}\n\n/**\n * Modified version of: https://github.com/component/debounce/blob/master/index.js\n * Returns a function, that, as long as it continues to be invoked, will not\n * be triggered. The function will be called after it stops being called for\n * N milliseconds. If `immediate` is passed, trigger the function on the\n * leading edge, instead of the trailing. The function also has a property 'clear'\n * that is a function which will clear the timer to prevent previously scheduled executions.\n *\n * @source underscore.js\n * @see http://unscriptable.com/2009/03/20/debouncing-javascript-methods/\n * @param {Function} function to wrap\n * @param {Number} timeout in ms (`100`)\n * @param {Boolean} whether to execute at the beginning (`false`)\n * @api public\n */\nexport function debounce (func /*: Function */, wait /*: number */, immediate /*: ?boolean */) /*: Function */ {\n  let timeout, args, context, timestamp, result\n  if (wait == null) wait = 100\n\n  function later () {\n    const last = Date.now() - timestamp\n\n    if (last < wait && last >= 0) {\n      timeout = setTimeout(later, wait - last)\n    } else {\n      timeout = null\n      if (!immediate) {\n        result = func.apply(context, args)\n        context = args = null\n      }\n    }\n  }\n\n  const debounced = function () {\n    context = this\n    args = arguments\n    timestamp = Date.now()\n    const callNow = immediate && !timeout\n    if (!timeout) timeout = setTimeout(later, wait)\n    if (callNow) {\n      result = func.apply(context, args)\n      context = args = null\n    }\n\n    return result\n  }\n\n  debounced.clear = function () {\n    if (timeout) {\n      clearTimeout(timeout)\n      timeout = null\n    }\n  }\n\n  debounced.flush = function () {\n    if (timeout) {\n      result = func.apply(context, args)\n      context = args = null\n      clearTimeout(timeout)\n      timeout = null\n    }\n  }\n\n  return debounced\n}\n\n/**\n * Gets the value at `path` of `obj`. If the resolved value is\n * `undefined`, the `defaultValue` is returned in its place.\n *\n */\nexport function get (obj /*: Object */, path /*: string[] */, defaultValue /*: any */) /*: any */ {\n  if (!path.length) {\n    return obj\n  } else if (obj === undefined) {\n    return defaultValue\n  }\n\n  let result = obj\n  let i = 0\n  while (result && i < path.length) {\n    result = result[path[i]]\n    i++\n  }\n\n  return result === undefined ? defaultValue : result\n}\n", "'use strict'\n\n// since this file is loaded by common.js, we avoid circular imports and directly import\nimport sbp from '@sbp/sbp'\nimport { defaultConfig as defaultDompurifyConfig } from './vSafeHtml.js'\nimport dompurify from 'dompurify'\nimport Vue from 'vue'\nimport template from './stringTemplate.js'\n\nVue.prototype.L = L\nVue.prototype.LTags = LTags\n\nconst defaultLanguage = 'en-US'\nconst defaultLanguageCode = 'en'\nconst defaultTranslationTable /*: { [string]: string } */ = {}\n\n/**\n * Allow 'href' and 'target' attributes to avoid breaking our hyperlinks,\n * but keep sanitizing their values.\n * See https://github.com/cure53/DOMPurify#can-i-configure-dompurify\n */\nconst dompurifyConfig = {\n  ...defaultDompurifyConfig,\n  ALLOWED_ATTR: ['class', 'href', 'rel', 'target'],\n  ALLOWED_TAGS: ['a', 'b', 'br', 'button', 'em', 'i', 'p', 'small', 'span', 'strong', 'sub', 'sup', 'u'],\n  RETURN_DOM_FRAGMENT: false\n}\n\nlet currentLanguage = defaultLanguage\nlet currentLanguageCode = defaultLanguage.split('-')[0]\nlet currentTranslationTable = defaultTranslationTable\n\n/**\n * Loads the translation file corresponding to a given language.\n *\n * @param language - A BPC-47 language tag like the value\n * of `navigator.language`.\n *\n * Language tags must be compared in a case-insensitive way (\u00A72.1.1.).\n *\n * @see https://tools.ietf.org/rfc/bcp/bcp47.txt\n */\nsbp('sbp/selectors/register', {\n  'translations/init': async function init (language /*: string */) /*: Promise<void> */ {\n    // A language code is usually the first part of a language tag.\n    const [languageCode] = language.toLowerCase().split('-')\n\n    // No need to do anything if the requested language is already in use.\n    if (language.toLowerCase() === currentLanguage.toLowerCase()) return\n\n    // We can also return early if only the language codes match,\n    //   since we don't have culture-specific translations yet.\n    if (languageCode === currentLanguageCode) return\n\n    // Avoid fetching any ressource if the requested language is the default one.\n    if (languageCode === defaultLanguageCode) {\n      currentLanguage = defaultLanguage\n      currentLanguageCode = defaultLanguageCode\n      currentTranslationTable = defaultTranslationTable\n      return\n    }\n    try {\n      currentTranslationTable = (await sbp('backend/translations/get', language)) || defaultTranslationTable\n\n      // Only set `currentLanguage` if there was no error fetching the ressource.\n      currentLanguage = language\n      currentLanguageCode = languageCode\n    } catch (error) {\n      console.error(error)\n    }\n  }\n})\n\n/*\nExamples:\n\nSimple string:\n  i18n Hello world\n\nString with variables:\n  i18n(\n    :args='{ name: ourUsername }'\n  ) Hello {name}!\n\nString with HTML markup inside:\n  i18n(\n    :args='{ ...LTags(\"strong\", \"span\"), name: ourUsername }'\n  ) Hello {strong_}{name}{_strong}, today it's a {span_}nice day{_span}!\n  | or\n  i18n(\n    :args='{ ...LTags(\"span\"), name: \"<strong>${ourUsername}</strong>\" }'\n  ) Hello {name}, today it's a {span_}nice day{_span}!\n\nString with Vue components inside:\n  i18n(\n    compile\n    :args='{ r1: `<router-link class=\"link\" to=\"/login\">`, r2: \"</router-link>\"}'\n  ) Go to {r1}login{r2} page.\n\n## When to use LTags or write html as part of the key?\n- Use LTags when they wrap a variable and raw text. Example:\n\n  i18n(\n    :args='{ count: 5, ...LTags(\"strong\") }'\n  ) Invite {strong}{count} members{strong} to the party!\n\n- Write HTML when it wraps only the variable.\n-- That way translators don't need to worry about extra information.\n  i18n(\n    :args='{ count: \"<strong>5</strong>\" }'\n  ) Invite {count} members to the party!\n*/\n\nexport function LTags (...tags /*: string[] */) /*: {|br_: string|} */ {\n  const o = {\n    'br_': '<br/>'\n  }\n  for (const tag of tags) {\n    o[`${tag}_`] = `<${tag}>`\n    o[`_${tag}`] = `</${tag}>`\n  }\n  return o\n}\n\nexport default function L (\n  key /*: string */,\n  args /*: Array<*> | Object | void */\n) /*: string */ {\n  return template(currentTranslationTable[key] || key, args)\n    // Avoid inopportune linebreaks before certain punctuations.\n    .replace(/\\s(?=[;:?!])/g, '&nbsp;')\n}\n\nexport function LError (error /*: Error */) /*: {|reportError: any|} */ {\n  let url = `/app/dashboard?modal=UserSettingsModal&section=application-logs&errorMsg=${encodeURI(error.message)}`\n  if (!sbp('state/vuex/state').loggedIn) {\n    url = 'https://github.com/okTurtles/group-income/issues'\n  }\n  return {\n    reportError: L('\"{errorMsg}\". You can {a_}report the error{_a}.', {\n      errorMsg: error.message,\n      'a_': `<a class=\"link\" target=\"_blank\" href=\"${url}\">`,\n      '_a': '</a>'\n    })\n  }\n}\n\nfunction sanitize (inputString) {\n  return dompurify.sanitize(inputString, dompurifyConfig)\n}\n\nVue.component('i18n', {\n  functional: true,\n  props: {\n    args: [Object, Array],\n    tag: {\n      type: String,\n      default: 'span'\n    },\n    compile: Boolean\n  },\n  render: function (h, context) {\n    const text = context.children[0].text\n    const translation = L(text, context.props.args || {})\n    if (!translation) {\n      console.warn('The following i18n text was not translated correctly:', text)\n      return h(context.props.tag, context.data, text)\n    }\n    // Prevent reverse tabnabbing by including `rel=\"noopener noreferrer\"` when rendering as an outbound hyperlink.\n    if (context.props.tag === 'a' && context.data.attrs.target === '_blank') {\n      context.data.attrs.rel = 'noopener noreferrer'\n    }\n    if (context.props.compile) {\n      const result = Vue.compile('<wrap>' + sanitize(translation) + '</wrap>')\n      // console.log('TRANSLATED RENDERED TEXT:', context, result.render.toString())\n      return result.render.call({\n        _c: (tag, ...args) => {\n          if (tag === 'wrap') {\n            return h(context.props.tag, context.data, ...args)\n          } else {\n            return h(tag, ...args)\n          }\n        },\n        _v: x => x\n      })\n    } else {\n      if (!context.data.domProps) context.data.domProps = {}\n      context.data.domProps.innerHTML = sanitize(translation)\n      return h(context.props.tag, context.data)\n    }\n  }\n})\n", "const nargs = /\\{([0-9a-zA-Z_]+)\\}/g\n\nexport default function template (string /*: string */, ...args /*: any[] */) /*: string */ {\n  const firstArg = args[0]\n  // If the first rest argument is a plain object or array, use it as replacement table.\n  // Otherwise, use the whole rest array as replacement table.\n  const replacementsByKey = (\n    (typeof firstArg === 'object' && firstArg !== null)\n      ? firstArg\n      : args\n  )\n\n  return string.replace(nargs, function replaceArg (match, capture, index) {\n    // Avoid replacing the capture if it is escaped by double curly braces.\n    if (string[index - 1] === '{' && string[index + match.length] === '}') {\n      return capture\n    }\n\n    const maybeReplacement = (\n      // Avoid accessing inherited properties of the replacement table.\n      // $FlowFixMe\n      Object.prototype.hasOwnProperty.call(replacementsByKey, capture)\n        ? replacementsByKey[capture]\n        : undefined\n    )\n\n    if (maybeReplacement === null || maybeReplacement === undefined) {\n      return ''\n    }\n    return String(maybeReplacement)\n  })\n}\n", "// to make rollup happy, I copied flowTyper-js\n// library into this file (it was refusing to\n// import because of the way functions were being\n// exported).\n//\n// GI EDIT NOTES:\n//\n// - The following functions can be used directly with 'validate'\n//   because they've had their '_scope' second parameter removed:\n//   - arrayOf\n//   - mapOf\n//   - object\n//   - objectOf\n//   - objectMaybeOf (this is a custom function that didn't exist in flowTyper)\n//\n// TODO: remove this file from eslintIgnore in package.json and fix errors\n\n                                             \n                                           \n                                                \n                                                      \n                                                       \n                                                            \n                                                 \n\n                                \n                   \n                  \n \n\n                                   \n                   \n                   \n                  \n \n\n                                      \n                   \n                   \n                   \n                   \n \n\n                                         \n                   \n                   \n                   \n                   \n                  \n \n\nexport const EMPTY_VALUE = Symbol('@@empty')\nexport const isEmpty = v => v === EMPTY_VALUE\nexport const isNil = v => v === null\nexport const isUndef = v => typeof v === 'undefined'\nexport const isBoolean = v => typeof v === 'boolean'\nexport const isNumber = v => typeof v === 'number'\nexport const isString = v => typeof v === 'string'\nexport const isObject = v => !isNil(v) && typeof v === 'object'\nexport const isFunction = v => typeof v === 'function'\n\nexport const isType = typeFn => (v, _scope = '') => {\n  try {\n    typeFn(v, _scope)\n    return true\n  } catch (_) {\n    return false\n  }\n}\n\n// This function will return value based on schema with inferred types. This\n// value can be used to define type in Flow with 'typeof' utility.\nexport const typeOf = schema => schema(EMPTY_VALUE, '')\nexport const getType = (typeFn, _options) => {\n  if (isFunction(typeFn.type)) return typeFn.type(_options)\n  return typeFn.name || '?'\n}\n\n// error\nexport class TypeValidatorError extends Error {\n  expectedType        \n  valueType        \n  value        \n  typeScope        \n  sourceFile        \n\n  constructor (\n    message         ,\n    expectedType        ,\n    valueType        ,\n    value        ,\n    typeName         = '',\n    typeScope          = ''\n  ) {\n    const errMessage = message ||\n      `invalid \"${valueType}\" value type; ${typeName || expectedType} type expected`\n    super(errMessage)\n    this.expectedType = expectedType\n    this.valueType = valueType\n    this.value = value\n    this.typeScope = typeScope || ''\n    this.sourceFile = this.getSourceFile()\n    this.message = `${errMessage}\\n${this.getErrorInfo()}`\n    this.name = this.constructor.name\n    if (Error.captureStackTrace) {\n      Error.captureStackTrace(this, TypeValidatorError)\n    }\n  }\n\n  getSourceFile ()         {\n    const fileNames = this.stack.match(/(\\/[\\w_\\-.]+)+(\\.\\w+:\\d+:\\d+)/g) || []\n    return fileNames.find(fileName => fileName.indexOf('/flowTyper-js/dist/') === -1) || ''\n  }\n\n  getErrorInfo ()         {\n    return `\n    file     ${this.sourceFile}\n    scope    ${this.typeScope}\n    expected ${this.expectedType.replace(/\\n/g, '')}\n    type     ${this.valueType}\n    value    ${this.value}\n`\n  }\n}\n\n// TypeValidatorError.prototype.name = 'TypeValidatorError'\n// exports.TypeValidatorError = TypeValidatorError\n\nconst validatorError =    (\n  typeFn                  ,\n  value       ,\n  scope         ,\n  message         ,\n  expectedType         ,\n  valueType         \n)                     => {\n  return new TypeValidatorError(\n    message,\n    expectedType || getType(typeFn),\n    valueType || typeof value,\n    JSON.stringify(value),\n    typeFn.name,\n    scope\n  )\n}\n\nexport const arrayOf =\n     (typeFn                  , _scope          = 'Array')                        => {\n    function array (value) {\n      if (isEmpty(value)) return [typeFn(value)]\n      if (Array.isArray(value)) {\n        let index = 0\n        return value.map(v => typeFn(v, `${_scope}[${index++}]`))\n      }\n      throw validatorError(array, value, _scope)\n    }\n    array.type = () => `Array<${getType(typeFn)}>`\n    return array\n  }\n\nexport const literalOf =\n                   (primitive   )                   => {\n    function literal (value, _scope = '') {\n      if (isEmpty(value) || (value === primitive)) return primitive\n      throw validatorError(literal, value, _scope)\n    }\n    literal.type = () => {\n      if (isBoolean(primitive)) return `${primitive ? 'true' : 'false'}`\n      else return `\"${primitive}\"`\n    }\n    return literal\n  }\n\nexport const mapOf =       (\n  keyTypeFn                  ,\n  typeFn                  \n)                            => {\n  function mapOf (value) {\n    if (isEmpty(value)) return {}\n    const o = object(value)\n    const reducer = (acc, key) =>\n      Object.assign(\n        acc,\n        {\n          // $FlowFixMe\n          [keyTypeFn(key, 'Map[_]')]: typeFn(o[key], `Map.${key}`)\n        }\n      )\n    return Object.keys(o).reduce(reducer, {})\n  }\n  mapOf.type = () => `{ [_:${getType(keyTypeFn)}]: ${getType(typeFn)} }`\n  return mapOf\n}\n\nconst isPrimitiveFn = (typeName) =>\n  ['undefined', 'null', 'boolean', 'number', 'string'].includes(typeName)\n\nexport const maybe =\n     (typeFn                  )                        => {\n    function maybe (value, _scope = '') {\n      return (isNil(value) || isUndef(value)) ? value : typeFn(value, _scope)\n    }\n    maybe.type = () => !isPrimitiveFn(typeFn.name) ? `?(${getType(typeFn)})` : `?${getType(typeFn)}`\n    return maybe\n  }\n\nexport const mixed = (\n  function mixed (value) {\n    return value\n  }                  \n)\n\nexport const object = (\n  function (value) {\n    if (isEmpty(value)) return {}\n    if (isObject(value) && !Array.isArray(value)) {\n      return Object.assign({}, value)\n    }\n    throw validatorError(object, value)\n  }                                    \n)\n\nexport const objectOf =                            \n  (typeObj   , _scope          = 'Object')                                                        => {\n  function object2 (value) {\n    const o = object(value)\n    const typeAttrs = Object.keys(typeObj)\n    const unknownAttr = Object.keys(o).find(attr => !typeAttrs.includes(attr))\n    if (unknownAttr) {\n      throw validatorError(\n        object2,\n        value,\n        _scope,\n        `missing object property '${unknownAttr}' in ${_scope} type`\n      )\n    }\n    // IMPORTANT: because esbuild can actually rename the functions in the compiled source\n    //            (e.g. from 'optional' to 'optional2'), we use .includes() instead of ===\n    //            to check the .name of a function\n    const undefAttr = typeAttrs.find(property => {\n      const propertyTypeFn = typeObj[property]\n      return (propertyTypeFn.name.includes('maybe') && !o.hasOwnProperty(property))\n    })\n    if (undefAttr) {\n      throw validatorError(\n        object2,\n        o[undefAttr],\n        `${_scope}.${undefAttr}`,\n        `empty object property '${undefAttr}' for ${_scope} type`,\n        `void | null | ${getType(typeObj[undefAttr]).substr(1)}`,\n        '-'\n      )\n    }\n\n    const reducer = isEmpty(value)\n      ? (acc, key) => Object.assign(acc, { [key]: typeObj[key](value) })\n      : (acc, key) => {\n        const typeFn = typeObj[key]\n        if (typeFn.name.includes('optional') && !o.hasOwnProperty(key)) {\n          return Object.assign(acc, {})\n        } else {\n          return Object.assign(acc, { [key]: typeFn(o[key], `${_scope}.${key}`) })\n        }\n      }\n    return typeAttrs.reduce(reducer, {})\n  }\n  object2.type = () => {\n    const props = Object.keys(typeObj).map(\n      (key) => {\n        const ret = typeObj[key].name.includes('optional')\n        ? `${key}?: ${getType(typeObj[key], { noVoid: true })}`\n        : `${key}: ${getType(typeObj[key])}`\n        return ret\n      }\n    )\n    return `{|\\n ${props.join(',\\n  ')} \\n|}`\n  }\n  return object2\n}\n\n// TODO: add flow type annotations and make it use validatorError etc.\nexport function objectMaybeOf (validations        , _scope          = 'Object')         {\n  return function (data     ) {\n    object(data)\n    for (const key in data) {\n      validations[key]?.(data[key], `${_scope}.${key}`)\n    }\n    return data\n  }\n}\n\nexport const optional =\n     (typeFn                  )                          => {\n    const unionFn = unionOf(typeFn, undef)\n    function optional (v) {\n      return unionFn(v)\n    }\n    optional.type = ({ noVoid }) => !noVoid ? getType(unionFn) : getType(typeFn)\n    return optional\n  }\n\nexport const nil = (\n  function nil (value) {\n    if (isEmpty(value) || isNil(value)) return null\n    throw validatorError(nil, value)\n  }\n                       \n)\n\nexport function undef (value, _scope = '') {\n  if (isEmpty(value) || isUndef(value)) return undefined\n  throw validatorError(undef, value, _scope)\n}\nundef.type = () => 'void'\n// export const undef = (undef: TypeValidator<void>)\n\nexport const boolean = (\n  function boolean (value, _scope = '') {\n    if (isEmpty(value)) return false\n    if (isBoolean(value)) return value\n    throw validatorError(boolean, value, _scope)\n  }\n                          \n)\n\nexport const number = (\n  function number (value, _scope = '') {\n    if (isEmpty(value)) return 0\n    if (isNumber(value)) return value\n    throw validatorError(number, value, _scope)\n  }\n                         \n)\n\nexport const string = (\n  function string (value, _scope = '') {\n    if (isEmpty(value)) return ''\n    if (isString(value)) return value\n    throw validatorError(string, value, _scope)\n  }\n                         \n)\n\n                            \n             \n                                     \n                                                 \n                                                             \n                                                                         \n                                                                                     \n                                                                                                 \n                                                                                                             \n                                                                                                                         \n                                                                                                                                     \n                                                                                                                                                 \n\nfunction tupleOf_ (...typeFuncs) {\n  function tuple (value       , _scope = '') {\n    const cardinality = typeFuncs.length\n    if (isEmpty(value)) return typeFuncs.map(fn => fn(value))\n    if (Array.isArray(value) && value.length === cardinality) {\n      const tupleValue = []\n      for (let i = 0; i < cardinality; i += 1) {\n        tupleValue.push(typeFuncs[i](value[i], _scope))\n      }\n      return tupleValue\n    }\n    throw validatorError(tuple, value, _scope)\n  }\n  tuple.type = () => `[${typeFuncs.map(fn => getType(fn)).join(', ')}]`\n  return tuple\n}\n\n// $FlowFixMe - $Tuple<(A, B, C, ...)[]>\n// const tupleOf: TupleT = tupleOf_\nexport const tupleOf = tupleOf_\n\n             \n                                   \n                                                \n                                                             \n                                                                          \n                                                                                       \n                                                                                                    \n                                                                                                                 \n                                                                                                                              \n                                                                                                                                           \n                                                                                                                                                        \n\nfunction unionOf_ (...typeFuncs) {\n  function union (value       , _scope = '') {\n    for (const typeFn of typeFuncs) {\n      try {\n        return typeFn(value, _scope)\n      } catch (_) {}\n    }\n    throw validatorError(union, value, _scope)\n  }\n  union.type = () => `(${typeFuncs.map(fn => getType(fn)).join(' | ')})`\n  return union\n}\n// $FlowFixMe\n// const unionOf: UnionT = (unionOf_)\nexport const unionOf = unionOf_", "// Matches strings of plain ASCII letters and digits, hyphens and underscores.\nexport const allowedUsernameCharacters = (value        )          => /^[\\w-]*$/.test(value)\n\n// Matches non-empty strings of plain ASCII letters and digits.\nexport const alphanumeric = (value        )          => /^[A-Za-z\\d]+$/.test(value)\n\nexport const noConsecutiveHyphensOrUnderscores = (value        )          => !value.includes('--') && !value.includes('__')\n\nexport const noLeadingOrTrailingHyphen = (value        )          => !value.startsWith('-') && !value.endsWith('-')\nexport const noLeadingOrTrailingUnderscore = (value        )          => !value.startsWith('_') && !value.endsWith('_')\n\nexport const decimals = (digits        )                               => (value        ) => Number.isInteger(value * Math.pow(10, digits))\n\nexport const noUppercase = (value        )          => value.toLowerCase() === value\n\nexport const noWhitespace = (value        )          => /^\\S+$/.test(value)\n", "'use strict'\n\n// identity.js related\n\nexport const IDENTITY_PASSWORD_MIN_CHARS = 7\nexport const IDENTITY_USERNAME_MAX_CHARS = 80\n\n// group.js related\n\nexport const INVITE_INITIAL_CREATOR = 'invite-initial-creator'\nexport const INVITE_STATUS = {\n  REVOKED: 'revoked',\n  VALID: 'valid',\n  USED: 'used'\n}\nexport const PROFILE_STATUS = {\n  ACTIVE: 'active', // confirmed group join\n  PENDING: 'pending', // shortly after being approved to join the group\n  REMOVED: 'removed'\n}\n\nexport const PROPOSAL_RESULT = 'proposal-result'\nexport const PROPOSAL_INVITE_MEMBER = 'invite-member'\nexport const PROPOSAL_REMOVE_MEMBER = 'remove-member'\nexport const PROPOSAL_GROUP_SETTING_CHANGE = 'group-setting-change'\nexport const PROPOSAL_PROPOSAL_SETTING_CHANGE = 'proposal-setting-change'\nexport const PROPOSAL_GENERIC = 'generic'\n\nexport const PROPOSAL_ARCHIVED = 'proposal-archived'\nexport const MAX_ARCHIVED_PROPOSALS = 100\n\nexport const STATUS_OPEN = 'open'\nexport const STATUS_PASSED = 'passed'\nexport const STATUS_FAILED = 'failed'\nexport const STATUS_EXPIRED = 'expired'\nexport const STATUS_CANCELLED = 'cancelled'\n\n// chatroom.js related\n\nexport const CHATROOM_GENERAL_NAME = 'General'\nexport const CHATROOM_NAME_LIMITS_IN_CHARS = 50\nexport const CHATROOM_DESCRIPTION_LIMITS_IN_CHARS = 280\nexport const CHATROOM_ACTIONS_PER_PAGE = 40\nexport const CHATROOM_MESSAGES_PER_PAGE = 20\n\n// chatroom events\nexport const CHATROOM_MESSAGE_ACTION = 'chatroom-message-action'\nexport const CHATROOM_DETAILS_UPDATED = 'chatroom-details-updated'\nexport const MESSAGE_RECEIVE = 'message-receive'\nexport const MESSAGE_SEND = 'message-send'\n\nexport const CHATROOM_TYPES = {\n  INDIVIDUAL: 'individual',\n  GROUP: 'group'\n}\n\nexport const CHATROOM_PRIVACY_LEVEL = {\n  GROUP: 'chatroom-privacy-level-group',\n  PRIVATE: 'chatroom-privacy-level-private',\n  PUBLIC: 'chatroom-privacy-level-public'\n}\n\nexport const MESSAGE_TYPES = {\n  POLL: 'message-poll',\n  TEXT: 'message-text',\n  INTERACTIVE: 'message-interactive',\n  NOTIFICATION: 'message-notification'\n}\n\nexport const INVITE_EXPIRES_IN_DAYS = {\n  ON_BOARDING: 30,\n  PROPOSAL: 7\n}\n\nexport const MESSAGE_NOTIFICATIONS = {\n  ADD_MEMBER: 'add-member',\n  JOIN_MEMBER: 'join-member',\n  LEAVE_MEMBER: 'leave-member',\n  KICK_MEMBER: 'kick-member',\n  UPDATE_DESCRIPTION: 'update-description',\n  UPDATE_NAME: 'update-name',\n  DELETE_CHANNEL: 'delete-channel',\n  VOTE: 'vote'\n}\n\nexport const MESSAGE_VARIANTS = {\n  PENDING: 'pending',\n  SENT: 'sent',\n  RECEIVED: 'received',\n  FAILED: 'failed'\n}\n\nexport const PROPOSAL_VARIANTS = {\n  CREATED: 'proposal-created',\n  EXPIRING: 'proposal-expiring',\n  ACCEPTED: 'proposal-accepted',\n  REJECTED: 'proposal-rejected',\n  EXPIRED: 'proposal-expired'\n}\n\n// mailbox.js related\n\nexport const MAIL_TYPE_MESSAGE = 'message'\nexport const MAIL_TYPE_FRIEND_REQ = 'friend-request'\n", "'use strict'\n\nimport sbp from '@sbp/sbp'\n\nimport { Vue, L } from '@common/common.js'\nimport { merge } from './shared/giLodash.js'\nimport { objectOf, objectMaybeOf, arrayOf, string, object } from '~/frontend/model/contracts/misc/flowTyper.js'\nimport {\n  allowedUsernameCharacters,\n  noConsecutiveHyphensOrUnderscores,\n  noLeadingOrTrailingHyphen,\n  noLeadingOrTrailingUnderscore,\n  noUppercase\n} from './shared/validators.js'\n\nimport { IDENTITY_USERNAME_MAX_CHARS } from './shared/constants.js'\n\nsbp('chelonia/defineContract', {\n  name: 'gi.contracts/identity',\n  getters: {\n    currentIdentityState (state) {\n      return state\n    },\n    loginState (state, getters) {\n      return getters.currentIdentityState.loginState\n    }\n  },\n  actions: {\n    'gi.contracts/identity': {\n      validate: (data, { state, meta }) => {\n        objectMaybeOf({\n          attributes: objectMaybeOf({\n            username: string,\n            email: string,\n            picture: string\n          })\n        })(data)\n        const { username } = data.attributes\n        if (username.length > IDENTITY_USERNAME_MAX_CHARS) {\n          throw new TypeError(`A username cannot exceed ${IDENTITY_USERNAME_MAX_CHARS} characters.`)\n        }\n        if (!allowedUsernameCharacters(username)) {\n          throw new TypeError('A username cannot contain disallowed characters.')\n        }\n        if (!noConsecutiveHyphensOrUnderscores(username)) {\n          throw new TypeError('A username cannot contain two consecutive hyphens or underscores.')\n        }\n        if (!noLeadingOrTrailingHyphen(username)) {\n          throw new TypeError('A username cannot start or end with a hyphen.')\n        }\n        if (!noLeadingOrTrailingUnderscore(username)) {\n          throw new TypeError('A username cannot start or end with an underscore.')\n        }\n        if (!noUppercase(username)) {\n          throw new TypeError('A username cannot contain uppercase letters.')\n        }\n      },\n      process ({ data }, { state }) {\n        const initialState = merge({\n          settings: {},\n          attributes: {}\n        }, data)\n        for (const key in initialState) {\n          Vue.set(state, key, initialState[key])\n        }\n      }\n    },\n    'gi.contracts/identity/setAttributes': {\n      validate: object,\n      process ({ data }, { state }) {\n        for (const key in data) {\n          Vue.set(state.attributes, key, data[key])\n        }\n      }\n    },\n    'gi.contracts/identity/deleteAttributes': {\n      validate: arrayOf(string),\n      process ({ data }, { state }) {\n        for (const attribute of data) {\n          Vue.delete(state.attributes, attribute)\n        }\n      }\n    },\n    'gi.contracts/identity/updateSettings': {\n      validate: object,\n      process ({ data }, { state }) {\n        for (const key in data) {\n          Vue.set(state.settings, key, data[key])\n        }\n      }\n    },\n    'gi.contracts/identity/setLoginState': {\n      validate: objectOf({\n        groupIds: arrayOf(string)\n      }),\n      process ({ data }, { state }) {\n        Vue.set(state, 'loginState', data)\n      },\n      sideEffect ({ contractID }) {\n        // it only makes sense to call updateLoginStateUponLogin for ourselves\n        if (contractID === sbp('state/vuex/getters').ourIdentityContractId) {\n          // makes sure that updateLoginStateUponLogin gets run after the entire identity\n          // state has been synced, this way we don't end up joining groups we've left, etc.\n          sbp('chelonia/queueInvocation', contractID, ['gi.actions/identity/updateLoginStateUponLogin'])\n            .catch((e) => {\n              sbp('gi.notifications/emit', 'ERROR', {\n                message: L(\"Failed to join groups we're part of on another device. Not catastrophic, but could lead to problems. {errName}: '{errMsg}'\", {\n                  errName: e.name,\n                  errMsg: e.message || '?'\n                })\n              })\n            })\n        }\n      }\n    }\n  }\n})\n"],
  "mappings": "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",
  "names": []
}

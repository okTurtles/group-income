{
  "version": 3,
  "sources": ["../../node_modules/@sbp/sbp/dist/module.mjs", "../../frontend/common/common.js", "../../frontend/common/vSafeHtml.js", "../../frontend/model/contracts/shared/giLodash.js", "../../frontend/common/translations.js", "../../frontend/common/stringTemplate.js", "../../frontend/common/errors.js", "../../frontend/model/contracts/misc/flowTyper.js", "../../frontend/model/contracts/shared/constants.js", "../../frontend/model/contracts/shared/voting/rules.js", "../../frontend/model/contracts/shared/time.js", "../../frontend/model/contracts/shared/voting/proposals.js", "../../frontend/model/contracts/shared/payments/index.js", "../../frontend/model/contracts/shared/distribution/mincome-proportional.js", "../../frontend/model/contracts/shared/distribution/payments-minimizer.js", "../../frontend/model/contracts/shared/currencies.js", "../../frontend/model/contracts/shared/distribution/distribution.js", "../../frontend/model/contracts/shared/types.js", "../../frontend/model/contracts/group.js"],
  "sourcesContent": ["// \n\n'use strict'\n\n\nconst selectors = {}\nconst domains = {}\nconst globalFilters = []\nconst domainFilters = {}\nconst selectorFilters = {}\nconst unsafeSelectors = {}\n\nconst DOMAIN_REGEX = /^[^/]+/\n\nfunction sbp (selector, ...data) {\n  const domain = domainFromSelector(selector)\n  if (!selectors[selector]) {\n    throw new Error(`SBP: selector not registered: ${selector}`)\n  }\n  // Filters can perform additional functions, and by returning `false` they\n  // can prevent the execution of a selector. Check the most specific filters first.\n  for (const filters of [selectorFilters[selector], domainFilters[domain], globalFilters]) {\n    if (filters) {\n      for (const filter of filters) {\n        if (filter(domain, selector, data) === false) return\n      }\n    }\n  }\n  return selectors[selector].call(domains[domain].state, ...data)\n}\n\nexport function domainFromSelector (selector) {\n  const domainLookup = DOMAIN_REGEX.exec(selector)\n  if (domainLookup === null) {\n    throw new Error(`SBP: selector missing domain: ${selector}`)\n  }\n  return domainLookup[0]\n}\n\nconst SBP_BASE_SELECTORS = {\n  'sbp/selectors/register': function (sels) {\n    const registered = []\n    for (const selector in sels) {\n      const domain = domainFromSelector(selector)\n      if (selectors[selector]) {\n        (console.warn || console.log)(`[SBP WARN]: not registering already registered selector: '${selector}'`)\n      } else if (typeof sels[selector] === 'function') {\n        if (unsafeSelectors[selector]) {\n          // important warning in case we loaded any malware beforehand and aren't expecting this\n          (console.warn || console.log)(`[SBP WARN]: registering unsafe selector: '${selector}' (remember to lock after overwriting)`)\n        }\n        const fn = selectors[selector] = sels[selector]\n        registered.push(selector)\n        // ensure each domain has a domain state associated with it\n        if (!domains[domain]) {\n          domains[domain] = { state: {} }\n        }\n        // call the special _init function immediately upon registering\n        if (selector === `${domain}/_init`) {\n          fn.call(domains[domain].state)\n        }\n      }\n    }\n    return registered\n  },\n  'sbp/selectors/unregister': function (sels) {\n    for (const selector of sels) {\n      if (!unsafeSelectors[selector]) {\n        throw new Error(`SBP: can't unregister locked selector: ${selector}`)\n      }\n      delete selectors[selector]\n    }\n  },\n  'sbp/selectors/overwrite': function (sels) {\n    sbp('sbp/selectors/unregister', Object.keys(sels))\n    return sbp('sbp/selectors/register', sels)\n  },\n  'sbp/selectors/unsafe': function (sels) {\n    for (const selector of sels) {\n      if (selectors[selector]) {\n        throw new Error('unsafe must be called before registering selector')\n      }\n      unsafeSelectors[selector] = true\n    }\n  },\n  'sbp/selectors/lock': function (sels) {\n    for (const selector of sels) {\n      delete unsafeSelectors[selector]\n    }\n  },\n  'sbp/selectors/fn': function (sel) {\n    return selectors[sel]\n  },\n  'sbp/filters/global/add': function (filter) {\n    globalFilters.push(filter)\n  },\n  'sbp/filters/domain/add': function (domain, filter) {\n    if (!domainFilters[domain]) domainFilters[domain] = []\n    domainFilters[domain].push(filter)\n  },\n  'sbp/filters/selector/add': function (selector, filter) {\n    if (!selectorFilters[selector]) selectorFilters[selector] = []\n    selectorFilters[selector].push(filter)\n  }\n}\n\nSBP_BASE_SELECTORS['sbp/selectors/register'](SBP_BASE_SELECTORS)\n\nexport default sbp\n", "'use strict'\n\n// This file allows us to deduplicate some code between the main app bundle and\n// the slim'd down contract bundles.\n// Any large shared dependencies between the contracts - that are unlikely to ever\n// change - go into this file. For example, we are using Vue between the frontend\n// and the contracts (for the Vue.set/Vue.delete functions), and those are unlikely\n// to ever change in their behavior. Therefore it's a perfect candidate to go in\n// this file, resulting a smaller overall bundle for the contract slim builds.\n// All other in-project code that's shared between the contracts should be\n// placed under 'frontend/model/contracts/shared/' and imported directly\n// from both the app and the contracts. This will result in some duplicated code being\n// loaded by the contracts (even the slim'd versions) and the main app, however,\n// it will ensure the safe and consistent operation of contracts, minimizing the\n// likelihood that there will ever be a conflict between their state and what the UI\n// expects the behavior to be.\n\n// EVERYTHING EXPORTED BY THIS FILE MUST ALWAYS AND ONLY BE IMPORTED\n// VIA \"/assets/js/common.js\"!\n// DO NOT CHANGE THE BEHAVIOR OF ANYTHING IMPORTED BY THIS FILE THAT AFFECTS THE\n// BEHAVIOR OF CONTRACTS IN ANY MEANINGFUL WAY!\n// Doing otherwise defeats the purpose of this file and could lead to bugs and conflicts!\n// You may *add* behavior, but never modify or remove it.\n\nexport { default as Vue } from 'vue'\nexport { default as L } from './translations.js'\nexport * from './translations.js'\nexport * from './errors.js'\nexport * as Errors from './errors.js'\n", "/*\n * Copyright GitLab B.V.\n *\n * Permission is hereby granted, free of charge, to any person obtaining a copy of this software and associated documentation files (the \"Software\"), to deal in the Software without restriction, including without limitation the rights to use, copy, modify, merge, publish, distribute, sublicense, and/or sell copies of the Software, and to permit persons to whom the Software is furnished to do so, subject to the following conditions:\n *\n * The above copyright notice and this permission notice shall be included in all copies or substantial portions of the Software.\n *\n * THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.\n */\n\n/*\n * This file is mainly a copy of the `safe-html.js` directive found in the\n * [gitlab-ui](https://gitlab.com/gitlab-org/gitlab-ui) project,\n * slightly modifed for linting purposes and to immediately register it via\n * `Vue.directive()` rather than exporting it, consistently with our other\n * custom Vue directives.\n */\n\nimport dompurify from 'dompurify'\nimport Vue from 'vue'\nimport { cloneDeep } from '~/frontend/model/contracts/shared/giLodash.js'\n\n// See https://github.com/cure53/DOMPurify#can-i-configure-dompurify\nexport const defaultConfig = {\n  ALLOWED_ATTR: ['class'],\n  ALLOWED_TAGS: ['b', 'br', 'em', 'i', 'p', 'small', 'span', 'strong', 'sub', 'sup', 'u'],\n  // This option was in the original file.\n  RETURN_DOM_FRAGMENT: true\n}\n\nconst transform = (el, binding) => {\n  if (binding.oldValue !== binding.value) {\n    let config = defaultConfig\n    if (binding.arg === 'a') {\n      config = cloneDeep(config)\n      config.ALLOWED_ATTR.push('href', 'target')\n      config.ALLOWED_TAGS.push('a')\n    }\n    el.textContent = ''\n    el.appendChild(dompurify.sanitize(binding.value, config))\n  }\n}\n\n/*\n * Register a global custom directive called `v-safe-html`.\n *\n * Please use this instead of `v-html` everywhere user input is expected,\n *   in order to avoid XSS vulnerabilities.\n *\n * See https://github.com/okTurtles/group-income/issues/975\n */\n\nVue.directive('safe-html', {\n  bind: transform,\n  update: transform\n})\n", "// manually implemented lodash functions are better than even:\n// https://github.com/lodash/babel-plugin-lodash\n// additional tiny versions of lodash functions are available in VueScript2\n\nexport function mapValues (obj, fn, o = {}) {\n  for (const key in obj) { o[key] = fn(obj[key]) }\n  return o\n}\n\nexport function mapObject (obj, fn) {\n  return Object.fromEntries(Object.entries(obj).map(fn))\n}\n\nexport function pick (o, props) {\n  const x = {}\n  for (const k of props) { x[k] = o[k] }\n  return x\n}\n\nexport function pickWhere (o, where) {\n  const x = {}\n  for (const k in o) {\n    if (where(o[k])) { x[k] = o[k] }\n  }\n  return x\n}\n\nexport function choose (array, indices) {\n  const x = []\n  for (const idx of indices) { x.push(array[idx]) }\n  return x\n}\n\nexport function omit (o, props) {\n  const x = {}\n  for (const k in o) {\n    if (!props.includes(k)) {\n      x[k] = o[k]\n    }\n  }\n  return x\n}\n\nexport function cloneDeep (obj) {\n  return JSON.parse(JSON.stringify(obj))\n}\n\nfunction isMergeableObject (val) {\n  const nonNullObject = val && typeof val === 'object'\n  // $FlowFixMe\n  return nonNullObject && Object.prototype.toString.call(val) !== '[object RegExp]' && Object.prototype.toString.call(val) !== '[object Date]'\n}\n\nexport function merge (obj, src) {\n  for (const key in src) {\n    const clone = isMergeableObject(src[key]) ? cloneDeep(src[key]) : undefined\n    if (clone && isMergeableObject(obj[key])) {\n      merge(obj[key], clone)\n      continue\n    }\n    obj[key] = clone || src[key]\n  }\n  return obj\n}\n\nexport function delay (msec) {\n  return new Promise((resolve, reject) => {\n    setTimeout(resolve, msec)\n  })\n}\n\nexport function randomBytes (length) {\n  // $FlowIssue crypto support: https://github.com/facebook/flow/issues/5019\n  return crypto.getRandomValues(new Uint8Array(length))\n}\n\nexport function randomHexString (length) {\n  return Array.from(randomBytes(length), byte => (byte % 16).toString(16)).join('')\n}\n\nexport function randomIntFromRange (min, max) {\n  return Math.floor(Math.random() * (max - min + 1) + min)\n}\n\nexport function randomFromArray (arr) {\n  return arr[Math.floor(Math.random() * arr.length)]\n}\n\nexport function flatten (arr) {\n  let flat = []\n  for (let i = 0; i < arr.length; i++) {\n    if (Array.isArray(arr[i])) {\n      flat = flat.concat(arr[i])\n    } else {\n      flat.push(arr[i])\n    }\n  }\n  return flat\n}\n\nexport function zip () {\n  // $FlowFixMe\n  const arr = Array.prototype.slice.call(arguments)\n  const zipped = []\n  let max = 0\n  arr.forEach((current) => (max = Math.max(max, current.length)))\n  for (const current of arr) {\n    for (let i = 0; i < max; i++) {\n      zipped[i] = zipped[i] || []\n      zipped[i].push(current[i])\n    }\n  }\n  return zipped\n}\n\nexport function uniq (array) {\n  return Array.from(new Set(array))\n}\n\nexport function union (...arrays) {\n  // $FlowFixMe\n  return uniq([].concat.apply([], arrays))\n}\n\nexport function intersection (a1, ...arrays) {\n  return uniq(a1).filter(v1 => arrays.every(v2 => v2.indexOf(v1) >= 0))\n}\n\nexport function difference (a1, ...arrays) {\n  // $FlowFixMe\n  const a2 = [].concat.apply([], arrays)\n  return a1.filter(v => a2.indexOf(v) === -1)\n}\n\nexport function deepEqualJSONType (a, b) {\n  if (a === b) return true\n  if (a === null || b === null || typeof (a) !== typeof (b)) return false\n  if (typeof a !== 'object') return a === b\n  if (Array.isArray(a)) {\n    if (a.length !== b.length) return false\n  } else if (a.constructor.name !== 'Object') {\n    throw new Error(`not JSON type: ${a}`)\n  }\n  for (const key in a) {\n    if (!deepEqualJSONType(a[key], b[key])) return false\n  }\n  return true\n}\n\n/**\n * Modified version of: https://github.com/component/debounce/blob/master/index.js\n * Returns a function, that, as long as it continues to be invoked, will not\n * be triggered. The function will be called after it stops being called for\n * N milliseconds. If `immediate` is passed, trigger the function on the\n * leading edge, instead of the trailing. The function also has a property 'clear'\n * that is a function which will clear the timer to prevent previously scheduled executions.\n *\n * @source underscore.js\n * @see http://unscriptable.com/2009/03/20/debouncing-javascript-methods/\n * @param {Function} function to wrap\n * @param {Number} timeout in ms (`100`)\n * @param {Boolean} whether to execute at the beginning (`false`)\n * @api public\n */\nexport function debounce (func, wait, immediate) {\n  let timeout, args, context, timestamp, result\n  if (wait == null) wait = 100\n\n  function later () {\n    const last = Date.now() - timestamp\n\n    if (last < wait && last >= 0) {\n      timeout = setTimeout(later, wait - last)\n    } else {\n      timeout = null\n      if (!immediate) {\n        result = func.apply(context, args)\n        context = args = null\n      }\n    }\n  }\n\n  const debounced = function () {\n    context = this\n    args = arguments\n    timestamp = Date.now()\n    const callNow = immediate && !timeout\n    if (!timeout) timeout = setTimeout(later, wait)\n    if (callNow) {\n      result = func.apply(context, args)\n      context = args = null\n    }\n\n    return result\n  }\n\n  debounced.clear = function () {\n    if (timeout) {\n      clearTimeout(timeout)\n      timeout = null\n    }\n  }\n\n  debounced.flush = function () {\n    if (timeout) {\n      result = func.apply(context, args)\n      context = args = null\n      clearTimeout(timeout)\n      timeout = null\n    }\n  }\n\n  return debounced\n}\n", "'use strict'\n\n// since this file is loaded by common.js, we avoid circular imports and directly import\nimport sbp from '@sbp/sbp'\nimport { defaultConfig as defaultDompurifyConfig } from './vSafeHtml.js'\nimport dompurify from 'dompurify'\nimport Vue from 'vue'\nimport template from './stringTemplate.js'\n\nVue.prototype.L = L\nVue.prototype.LTags = LTags\n\nconst defaultLanguage = 'en-US'\nconst defaultLanguageCode = 'en'\nconst defaultTranslationTable                       = {}\n\n/**\n * Allow 'href' and 'target' attributes to avoid breaking our hyperlinks,\n * but keep sanitizing their values.\n * See https://github.com/cure53/DOMPurify#can-i-configure-dompurify\n */\nconst dompurifyConfig = {\n  ...defaultDompurifyConfig,\n  ALLOWED_ATTR: ['class', 'href', 'rel', 'target'],\n  ALLOWED_TAGS: ['a', 'b', 'br', 'button', 'em', 'i', 'p', 'small', 'span', 'strong', 'sub', 'sup', 'u'],\n  RETURN_DOM_FRAGMENT: false\n}\n\nlet currentLanguage = defaultLanguage\nlet currentLanguageCode = defaultLanguage.split('-')[0]\nlet currentTranslationTable = defaultTranslationTable\n\n/**\n * Loads the translation file corresponding to a given language.\n *\n * @param language - A BPC-47 language tag like the value\n * of `navigator.language`.\n *\n * Language tags must be compared in a case-insensitive way (\u00A72.1.1.).\n *\n * @see https://tools.ietf.org/rfc/bcp/bcp47.txt\n */\nsbp('sbp/selectors/register', {\n  'translations/init': async function init (language        )                {\n    // A language code is usually the first part of a language tag.\n    const [languageCode] = language.toLowerCase().split('-')\n\n    // No need to do anything if the requested language is already in use.\n    if (language.toLowerCase() === currentLanguage.toLowerCase()) return\n\n    // We can also return early if only the language codes match,\n    //   since we don't have culture-specific translations yet.\n    if (languageCode === currentLanguageCode) return\n\n    // Avoid fetching any ressource if the requested language is the default one.\n    if (languageCode === defaultLanguageCode) {\n      currentLanguage = defaultLanguage\n      currentLanguageCode = defaultLanguageCode\n      currentTranslationTable = defaultTranslationTable\n      return\n    }\n    try {\n      currentTranslationTable = (await sbp('backend/translations/get', language)) || defaultTranslationTable\n\n      // Only set `currentLanguage` if there was no error fetching the ressource.\n      currentLanguage = language\n      currentLanguageCode = languageCode\n    } catch (error) {\n      console.error(error)\n    }\n  }\n})\n\n/*\nExamples:\n\nSimple string:\n  i18n Hello world\n\nString with variables:\n  i18n(\n    :args='{ name: ourUsername }'\n  ) Hello {name}!\n\nString with HTML markup inside:\n  i18n(\n    :args='{ ...LTags(\"strong\", \"span\"), name: ourUsername }'\n  ) Hello {strong_}{name}{_strong}, today it's a {span_}nice day{_span}!\n  | or\n  i18n(\n    :args='{ ...LTags(\"span\"), name: \"<strong>${ourUsername}</strong>\" }'\n  ) Hello {name}, today it's a {span_}nice day{_span}!\n\nString with Vue components inside:\n  i18n(\n    compile\n    :args='{ r1: `<router-link class=\"link\" to=\"/login\">`, r2: \"</router-link>\"}'\n  ) Go to {r1}login{r2} page.\n\n## When to use LTags or write html as part of the key?\n- Use LTags when they wrap a variable and raw text. Example:\n\n  i18n(\n    :args='{ count: 5, ...LTags(\"strong\") }'\n  ) Invite {strong}{count} members{strong} to the party!\n\n- Write HTML when it wraps only the variable.\n-- That way translators don't need to worry about extra information.\n  i18n(\n    :args='{ count: \"<strong>5</strong>\" }'\n  ) Invite {count} members to the party!\n*/\n\nexport function LTags (...tags          )                  {\n  const o = {\n    'br_': '<br/>'\n  }\n  for (const tag of tags) {\n    o[`${tag}_`] = `<${tag}>`\n    o[`_${tag}`] = `</${tag}>`\n  }\n  return o\n}\n\nexport default function L (\n  key        ,\n  args                          \n)         {\n  return template(currentTranslationTable[key] || key, args)\n    // Avoid inopportune linebreaks before certain punctuations.\n    .replace(/\\s(?=[;:?!])/g, '&nbsp;')\n}\n\nexport function LError (error       )                       {\n  let url = `/app/dashboard?modal=UserSettingsModal&section=application-logs&errorMsg=${encodeURI(error.message)}`\n  if (!sbp('state/vuex/state').loggedIn) {\n    url = 'https://github.com/okTurtles/group-income/issues'\n  }\n  return {\n    reportError: L('\"{errorMsg}\". You can {a_}report the error{_a}.', {\n      errorMsg: error.message,\n      'a_': `<a class=\"link\" target=\"_blank\" href=\"${url}\">`,\n      '_a': '</a>'\n    })\n  }\n}\n\nfunction sanitize (inputString) {\n  return dompurify.sanitize(inputString, dompurifyConfig)\n}\n\nVue.component('i18n', {\n  functional: true,\n  props: {\n    args: [Object, Array],\n    tag: {\n      type: String,\n      default: 'span'\n    },\n    compile: Boolean\n  },\n  render: function (h, context) {\n    const text = context.children[0].text\n    const translation = L(text, context.props.args || {})\n    if (!translation) {\n      console.warn('The following i18n text was not translated correctly:', text)\n      return h(context.props.tag, context.data, text)\n    }\n    // Prevent reverse tabnabbing by including `rel=\"noopener noreferrer\"` when rendering as an outbound hyperlink.\n    if (context.props.tag === 'a' && context.data.attrs.target === '_blank') {\n      context.data.attrs.rel = 'noopener noreferrer'\n    }\n    if (context.props.compile) {\n      const result = Vue.compile('<wrap>' + sanitize(translation) + '</wrap>')\n      // console.log('TRANSLATED RENDERED TEXT:', context, result.render.toString())\n      return result.render.call({\n        _c: (tag, ...args) => {\n          if (tag === 'wrap') {\n            return h(context.props.tag, context.data, ...args)\n          } else {\n            return h(tag, ...args)\n          }\n        },\n        _v: x => x\n      })\n    } else {\n      if (!context.data.domProps) context.data.domProps = {}\n      context.data.domProps.innerHTML = sanitize(translation)\n      return h(context.props.tag, context.data)\n    }\n  }\n})\n", "const nargs = /\\{([0-9a-zA-Z_]+)\\}/g\n\nexport default function template (string        , ...args       )         {\n  const firstArg = args[0]\n  // If the first rest argument is a plain object or array, use it as replacement table.\n  // Otherwise, use the whole rest array as replacement table.\n  const replacementsByKey = (\n    (typeof firstArg === 'object' && firstArg !== null)\n      ? firstArg\n      : args\n  )\n\n  return string.replace(nargs, function replaceArg (match, capture, index) {\n    // Avoid replacing the capture if it is escaped by double curly braces.\n    if (string[index - 1] === '{' && string[index + match.length] === '}') {\n      return capture\n    }\n\n    const maybeReplacement = (\n      // Avoid accessing inherited properties of the replacement table.\n      // $FlowFixMe\n      Object.prototype.hasOwnProperty.call(replacementsByKey, capture)\n        ? replacementsByKey[capture]\n        : undefined\n    )\n\n    if (maybeReplacement === null || maybeReplacement === undefined) {\n      return ''\n    }\n    return String(maybeReplacement)\n  })\n}\n", "'use strict'\n\nexport class GIErrorIgnoreAndBan extends Error {\n  // ugly boilerplate because JavaScript is stupid\n  // https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Error#Custom_Error_Types\n  constructor (...params       ) {\n    super(...params)\n    this.name = 'GIErrorIgnoreAndBan'\n    if (Error.captureStackTrace) {\n      Error.captureStackTrace(this, this.constructor)\n    }\n  }\n}\n\n// Used to throw human readable errors on UI.\nexport class GIErrorUIRuntimeError extends Error {\n  constructor (...params       ) {\n    super(...params)\n    // this.name = this.constructor.name\n    this.name = 'GIErrorUIRuntimeError' // string literal so minifier doesn't overwrite\n    if (Error.captureStackTrace) {\n      Error.captureStackTrace(this, this.constructor)\n    }\n  }\n}\n", "// to make rollup happy, I copied flowTyper-js\n// library into this file (it was refusing to\n// import because of the way functions were being\n// exported).\n//\n// GI EDIT NOTES:\n//\n// - The following functions can be used directly with 'validate'\n//   because they've had their '_scope' second parameter removed:\n//   - arrayOf\n//   - mapOf\n//   - object\n//   - objectOf\n//   - objectMaybeOf (this is a custom function that didn't exist in flowTyper)\n//\n// TODO: remove this file from eslintIgnore in package.json and fix errors\n\n                                             \n                                           \n                                                \n                                                      \n                                                       \n                                                            \n                                                 \n\n                                \n                   \n                  \n \n\n                                   \n                   \n                   \n                  \n \n\n                                      \n                   \n                   \n                   \n                   \n \n\n                                         \n                   \n                   \n                   \n                   \n                  \n \n\nexport const EMPTY_VALUE = Symbol('@@empty')\nexport const isEmpty = v => v === EMPTY_VALUE\nexport const isNil = v => v === null\nexport const isUndef = v => typeof v === 'undefined'\nexport const isBoolean = v => typeof v === 'boolean'\nexport const isNumber = v => typeof v === 'number'\nexport const isString = v => typeof v === 'string'\nexport const isObject = v => !isNil(v) && typeof v === 'object'\nexport const isFunction = v => typeof v === 'function'\n\nexport const isType = typeFn => (v, _scope = '') => {\n  try {\n    typeFn(v, _scope)\n    return true\n  } catch (_) {\n    return false\n  }\n}\n\n// This function will return value based on schema with inferred types. This\n// value can be used to define type in Flow with 'typeof' utility.\nexport const typeOf = schema => schema(EMPTY_VALUE, '')\nexport const getType = (typeFn, _options) => {\n  if (isFunction(typeFn.type)) return typeFn.type(_options)\n  return typeFn.name || '?'\n}\n\n// error\nexport class TypeValidatorError extends Error {\n  expectedType        \n  valueType        \n  value        \n  typeScope        \n  sourceFile        \n\n  constructor (\n    message         ,\n    expectedType        ,\n    valueType        ,\n    value        ,\n    typeName         = '',\n    typeScope          = ''\n  ) {\n    const errMessage = message ||\n      `invalid \"${valueType}\" value type; ${typeName || expectedType} type expected`\n    super(errMessage)\n    this.expectedType = expectedType\n    this.valueType = valueType\n    this.value = value\n    this.typeScope = typeScope || ''\n    this.sourceFile = this.getSourceFile()\n    this.message = `${errMessage}\\n${this.getErrorInfo()}`\n    this.name = this.constructor.name\n    if (Error.captureStackTrace) {\n      Error.captureStackTrace(this, TypeValidatorError)\n    }\n  }\n\n  getSourceFile ()         {\n    const fileNames = this.stack.match(/(\\/[\\w_\\-.]+)+(\\.\\w+:\\d+:\\d+)/g) || []\n    return fileNames.find(fileName => fileName.indexOf('/flowTyper-js/dist/') === -1) || ''\n  }\n\n  getErrorInfo ()         {\n    return `\n    file     ${this.sourceFile}\n    scope    ${this.typeScope}\n    expected ${this.expectedType.replace(/\\n/g, '')}\n    type     ${this.valueType}\n    value    ${this.value}\n`\n  }\n}\n\n// TypeValidatorError.prototype.name = 'TypeValidatorError'\n// exports.TypeValidatorError = TypeValidatorError\n\nconst validatorError =    (\n  typeFn                  ,\n  value       ,\n  scope         ,\n  message         ,\n  expectedType         ,\n  valueType         \n)                     => {\n  return new TypeValidatorError(\n    message,\n    expectedType || getType(typeFn),\n    valueType || typeof value,\n    JSON.stringify(value),\n    typeFn.name,\n    scope\n  )\n}\n\nexport const arrayOf =\n     (typeFn                  , _scope          = 'Array')                        => {\n    function array (value) {\n      if (isEmpty(value)) return [typeFn(value)]\n      if (Array.isArray(value)) {\n        let index = 0\n        return value.map(v => typeFn(v, `${_scope}[${index++}]`))\n      }\n      throw validatorError(array, value, _scope)\n    }\n    array.type = () => `Array<${getType(typeFn)}>`\n    return array\n  }\n\nexport const literalOf =\n                   (primitive   )                   => {\n    function literal (value, _scope = '') {\n      if (isEmpty(value) || (value === primitive)) return primitive\n      throw validatorError(literal, value, _scope)\n    }\n    literal.type = () => {\n      if (isBoolean(primitive)) return `${primitive ? 'true' : 'false'}`\n      else return `\"${primitive}\"`\n    }\n    return literal\n  }\n\nexport const mapOf =       (\n  keyTypeFn                  ,\n  typeFn                  \n)                            => {\n  function mapOf (value) {\n    if (isEmpty(value)) return {}\n    const o = object(value)\n    const reducer = (acc, key) =>\n      Object.assign(\n        acc,\n        {\n          // $FlowFixMe\n          [keyTypeFn(key, 'Map[_]')]: typeFn(o[key], `Map.${key}`)\n        }\n      )\n    return Object.keys(o).reduce(reducer, {})\n  }\n  mapOf.type = () => `{ [_:${getType(keyTypeFn)}]: ${getType(typeFn)} }`\n  return mapOf\n}\n\nconst isPrimitiveFn = (typeName) =>\n  ['undefined', 'null', 'boolean', 'number', 'string'].includes(typeName)\n\nexport const maybe =\n     (typeFn                  )                        => {\n    function maybe (value, _scope = '') {\n      return (isNil(value) || isUndef(value)) ? value : typeFn(value, _scope)\n    }\n    maybe.type = () => !isPrimitiveFn(typeFn.name) ? `?(${getType(typeFn)})` : `?${getType(typeFn)}`\n    return maybe\n  }\n\nexport const mixed = (\n  function mixed (value) {\n    return value\n  }                  \n)\n\nexport const object = (\n  function (value) {\n    if (isEmpty(value)) return {}\n    if (isObject(value) && !Array.isArray(value)) {\n      return Object.assign({}, value)\n    }\n    throw validatorError(object, value)\n  }                                    \n)\n\nexport const objectOf =                            \n  (typeObj   , _scope          = 'Object')                                                        => {\n  function object2 (value) {\n    const o = object(value)\n    const typeAttrs = Object.keys(typeObj)\n    const unknownAttr = Object.keys(o).find(attr => !typeAttrs.includes(attr))\n    if (unknownAttr) {\n      throw validatorError(\n        object2,\n        value,\n        _scope,\n        `missing object property '${unknownAttr}' in ${_scope} type`\n      )\n    }\n    // IMPORTANT: because esbuild can actually rename the functions in the compiled source\n    //            (e.g. from 'optional' to 'optional2'), we use .includes() instead of ===\n    //            to check the .name of a function\n    const undefAttr = typeAttrs.find(property => {\n      const propertyTypeFn = typeObj[property]\n      return (propertyTypeFn.name.includes('maybe') && !o.hasOwnProperty(property))\n    })\n    if (undefAttr) {\n      throw validatorError(\n        object2,\n        o[undefAttr],\n        `${_scope}.${undefAttr}`,\n        `empty object property '${undefAttr}' for ${_scope} type`,\n        `void | null | ${getType(typeObj[undefAttr]).substr(1)}`,\n        '-'\n      )\n    }\n\n    const reducer = isEmpty(value)\n      ? (acc, key) => Object.assign(acc, { [key]: typeObj[key](value) })\n      : (acc, key) => {\n        const typeFn = typeObj[key]\n        if (typeFn.name.includes('optional') && !o.hasOwnProperty(key)) {\n          return Object.assign(acc, {})\n        } else {\n          return Object.assign(acc, { [key]: typeFn(o[key], `${_scope}.${key}`) })\n        }\n      }\n    return typeAttrs.reduce(reducer, {})\n  }\n  object2.type = () => {\n    const props = Object.keys(typeObj).map(\n      (key) => {\n        const ret = typeObj[key].name.includes('optional')\n        ? `${key}?: ${getType(typeObj[key], { noVoid: true })}`\n        : `${key}: ${getType(typeObj[key])}`\n        return ret\n      }\n    )\n    return `{|\\n ${props.join(',\\n  ')} \\n|}`\n  }\n  return object2\n}\n\n// TODO: add flow type annotations and make it use validatorError etc.\nexport function objectMaybeOf (validations        , _scope          = 'Object')         {\n  return function (data     ) {\n    object(data)\n    for (const key in data) {\n      validations[key]?.(data[key], `${_scope}.${key}`)\n    }\n    return data\n  }\n}\n\nexport const optional =\n     (typeFn                  )                          => {\n    const unionFn = unionOf(typeFn, undef)\n    function optional (v) {\n      return unionFn(v)\n    }\n    optional.type = ({ noVoid }) => !noVoid ? getType(unionFn) : getType(typeFn)\n    return optional\n  }\n\nexport const nil = (\n  function nil (value) {\n    if (isEmpty(value) || isNil(value)) return null\n    throw validatorError(nil, value)\n  }\n                       \n)\n\nexport function undef (value, _scope = '') {\n  if (isEmpty(value) || isUndef(value)) return undefined\n  throw validatorError(undef, value, _scope)\n}\nundef.type = () => 'void'\n// export const undef = (undef: TypeValidator<void>)\n\nexport const boolean = (\n  function boolean (value, _scope = '') {\n    if (isEmpty(value)) return false\n    if (isBoolean(value)) return value\n    throw validatorError(boolean, value, _scope)\n  }\n                          \n)\n\nexport const number = (\n  function number (value, _scope = '') {\n    if (isEmpty(value)) return 0\n    if (isNumber(value)) return value\n    throw validatorError(number, value, _scope)\n  }\n                         \n)\n\nexport const string = (\n  function string (value, _scope = '') {\n    if (isEmpty(value)) return ''\n    if (isString(value)) return value\n    throw validatorError(string, value, _scope)\n  }\n                         \n)\n\n                            \n             \n                                     \n                                                 \n                                                             \n                                                                         \n                                                                                     \n                                                                                                 \n                                                                                                             \n                                                                                                                         \n                                                                                                                                     \n                                                                                                                                                 \n\nfunction tupleOf_ (...typeFuncs) {\n  function tuple (value       , _scope = '') {\n    const cardinality = typeFuncs.length\n    if (isEmpty(value)) return typeFuncs.map(fn => fn(value))\n    if (Array.isArray(value) && value.length === cardinality) {\n      const tupleValue = []\n      for (let i = 0; i < cardinality; i += 1) {\n        tupleValue.push(typeFuncs[i](value[i], _scope))\n      }\n      return tupleValue\n    }\n    throw validatorError(tuple, value, _scope)\n  }\n  tuple.type = () => `[${typeFuncs.map(fn => getType(fn)).join(', ')}]`\n  return tuple\n}\n\n// $FlowFixMe - $Tuple<(A, B, C, ...)[]>\n// const tupleOf: TupleT = tupleOf_\nexport const tupleOf = tupleOf_\n\n             \n                                   \n                                                \n                                                             \n                                                                          \n                                                                                       \n                                                                                                    \n                                                                                                                 \n                                                                                                                              \n                                                                                                                                           \n                                                                                                                                                        \n\nfunction unionOf_ (...typeFuncs) {\n  function union (value       , _scope = '') {\n    for (const typeFn of typeFuncs) {\n      try {\n        return typeFn(value, _scope)\n      } catch (_) {}\n    }\n    throw validatorError(union, value, _scope)\n  }\n  union.type = () => `(${typeFuncs.map(fn => getType(fn)).join(' | ')})`\n  return union\n}\n// $FlowFixMe\n// const unionOf: UnionT = (unionOf_)\nexport const unionOf = unionOf_", "'use strict'\n\n// identity.js related\n\nexport const IDENTITY_PASSWORD_MIN_CHARS = 7\nexport const IDENTITY_USERNAME_MAX_CHARS = 80\n\n// group.js related\n\nexport const INVITE_INITIAL_CREATOR = 'invite-initial-creator'\nexport const INVITE_STATUS = {\n  REVOKED: 'revoked',\n  VALID: 'valid',\n  USED: 'used'\n}\nexport const PROFILE_STATUS = {\n  ACTIVE: 'active', // confirmed group join\n  PENDING: 'pending', // shortly after being approved to join the group\n  REMOVED: 'removed'\n}\n\nexport const PROPOSAL_RESULT = 'proposal-result'\nexport const PROPOSAL_INVITE_MEMBER = 'invite-member'\nexport const PROPOSAL_REMOVE_MEMBER = 'remove-member'\nexport const PROPOSAL_GROUP_SETTING_CHANGE = 'group-setting-change'\nexport const PROPOSAL_PROPOSAL_SETTING_CHANGE = 'proposal-setting-change'\nexport const PROPOSAL_GENERIC = 'generic'\n\nexport const PROPOSAL_ARCHIVED = 'proposal-archived'\nexport const MAX_ARCHIVED_PROPOSALS = 100\n\nexport const STATUS_OPEN = 'open'\nexport const STATUS_PASSED = 'passed'\nexport const STATUS_FAILED = 'failed'\nexport const STATUS_EXPIRED = 'expired'\nexport const STATUS_CANCELLED = 'cancelled'\n\n// chatroom.js related\n\nexport const CHATROOM_GENERAL_NAME = 'General'\nexport const CHATROOM_NAME_LIMITS_IN_CHARS = 50\nexport const CHATROOM_DESCRIPTION_LIMITS_IN_CHARS = 280\nexport const CHATROOM_ACTIONS_PER_PAGE = 40\nexport const CHATROOM_MESSAGES_PER_PAGE = 20\n\n// chatroom events\nexport const CHATROOM_MESSAGE_ACTION = 'chatroom-message-action'\nexport const CHATROOM_DETAILS_UPDATED = 'chatroom-details-updated'\nexport const MESSAGE_RECEIVE = 'message-receive'\nexport const MESSAGE_SEND = 'message-send'\n\nexport const CHATROOM_TYPES = {\n  INDIVIDUAL: 'individual',\n  GROUP: 'group'\n}\n\nexport const CHATROOM_PRIVACY_LEVEL = {\n  GROUP: 'chatroom-privacy-level-group',\n  PRIVATE: 'chatroom-privacy-level-private',\n  PUBLIC: 'chatroom-privacy-level-public'\n}\n\nexport const MESSAGE_TYPES = {\n  POLL: 'message-poll',\n  TEXT: 'message-text',\n  INTERACTIVE: 'message-interactive',\n  NOTIFICATION: 'message-notification'\n}\n\nexport const INVITE_EXPIRES_IN_DAYS = {\n  ON_BOARDING: 30,\n  PROPOSAL: 7\n}\n\nexport const MESSAGE_NOTIFICATIONS = {\n  ADD_MEMBER: 'add-member',\n  JOIN_MEMBER: 'join-member',\n  LEAVE_MEMBER: 'leave-member',\n  KICK_MEMBER: 'kick-member',\n  UPDATE_DESCRIPTION: 'update-description',\n  UPDATE_NAME: 'update-name',\n  DELETE_CHANNEL: 'delete-channel',\n  VOTE: 'vote'\n}\n\nexport const MESSAGE_VARIANTS = {\n  PENDING: 'pending',\n  SENT: 'sent',\n  RECEIVED: 'received',\n  FAILED: 'failed'\n}\n\n// mailbox.js related\n\nexport const MAIL_TYPE_MESSAGE = 'message'\nexport const MAIL_TYPE_FRIEND_REQ = 'friend-request'\n", "'use strict'\n\nimport { literalOf, unionOf } from '~/frontend/model/contracts/misc/flowTyper.js'\nimport {\n  PROPOSAL_REMOVE_MEMBER,\n  PROFILE_STATUS\n} from '../constants.js'\n\nexport const VOTE_AGAINST = ':against'\nexport const VOTE_INDIFFERENT = ':indifferent'\nexport const VOTE_UNDECIDED = ':undecided'\nexport const VOTE_FOR = ':for'\n\nexport const RULE_PERCENTAGE = 'percentage'\nexport const RULE_DISAGREEMENT = 'disagreement'\nexport const RULE_MULTI_CHOICE = 'multi-choice'\n\n// TODO: ranked-choice? :D\n\n/* REVIVEW PR\n  the whole \"state\" being passed as argument to rules[rule]() is overwhelmed.\n  It would be simpler with just 2 simple args: \"threshold\" and \"population\".\n  Advantages:\n  - population: No need to do the logic to get it (and avoid import PROFILE_STATUS.ACTIVE from group.js).\n  - threshold: The selector to get the selector is huge.\n  - tests: Avoid the need to mock a complex state.\n  My suggestion: 1 parameter (object) with 4 explicit keys.\n  [RULE_PERCENTAGE]: function ({ votes, proposalType, population, threshold })\n*/\n\nconst getPopulation = (state) => Object.keys(state.profiles).filter(p => state.profiles[p].status === PROFILE_STATUS.ACTIVE).length\n\nconst rules         = {\n  [RULE_PERCENTAGE]: function (state, proposalType, votes) {\n    votes = Object.values(votes)\n    let population = getPopulation(state)\n    if (proposalType === PROPOSAL_REMOVE_MEMBER) population -= 1\n    const defaultThreshold = state.settings.proposals[proposalType].ruleSettings[RULE_PERCENTAGE].threshold\n    const threshold = getThresholdAdjusted(RULE_PERCENTAGE, defaultThreshold, population)\n    const totalIndifferent = votes.filter(x => x === VOTE_INDIFFERENT).length\n    const totalFor = votes.filter(x => x === VOTE_FOR).length\n    const totalAgainst = votes.filter(x => x === VOTE_AGAINST).length\n    const totalForOrAgainst = totalFor + totalAgainst\n    const turnout = totalForOrAgainst + totalIndifferent\n    const absent = population - turnout\n    // TODO: figure out if this is the right way to figure out the \"neededToPass\" number\n    //       and if so, explain it in the UI that the threshold is applied only to\n    //       *those who care, plus those who were abscent*.\n    //       Those who explicitely say they don't care are removed from consideration.\n    const neededToPass = Math.ceil(threshold * (population - totalIndifferent))\n    console.debug(`votingRule ${RULE_PERCENTAGE} for ${proposalType}:`, { neededToPass, totalFor, totalAgainst, totalIndifferent, threshold, absent, turnout, population })\n    if (totalFor >= neededToPass) {\n      return VOTE_FOR\n    }\n    return totalFor + absent < neededToPass ? VOTE_AGAINST : VOTE_UNDECIDED\n  },\n  [RULE_DISAGREEMENT]: function (state, proposalType, votes) {\n    votes = Object.values(votes)\n    const population = getPopulation(state)\n    const minimumMax = proposalType === PROPOSAL_REMOVE_MEMBER ? 2 : 1\n    const thresholdOriginal = Math.max(state.settings.proposals[proposalType].ruleSettings[RULE_DISAGREEMENT].threshold, minimumMax)\n    const threshold = getThresholdAdjusted(RULE_DISAGREEMENT, thresholdOriginal, population)\n    const totalFor = votes.filter(x => x === VOTE_FOR).length\n    const totalAgainst = votes.filter(x => x === VOTE_AGAINST).length\n    const turnout = votes.length\n    const absent = population - turnout\n\n    console.debug(`votingRule ${RULE_DISAGREEMENT} for ${proposalType}:`, { totalFor, totalAgainst, threshold, turnout, population, absent })\n    if (totalAgainst >= threshold) {\n      return VOTE_AGAINST\n    }\n    // consider proposal passed if more vote for it than against it and there aren't\n    // enough votes left to tip the scales past the threshold\n    return totalAgainst + absent < threshold ? VOTE_FOR : VOTE_UNDECIDED\n  },\n  [RULE_MULTI_CHOICE]: function (state, proposalType, votes) {\n    throw new Error('unimplemented!')\n    // TODO: return VOTE_UNDECIDED if 0 votes, otherwise value w/greatest number of votes\n    //       the proposal/poll is considered passed only after the expiry time period\n    // NOTE: are we sure though that this even belongs here as a voting rule...?\n    //       perhaps there could be a situation were one of several valid settings options\n    //       is being proposed... in effect this would be a plurality voting rule\n  }\n}\n\nexport default rules\n\nexport const ruleType      = unionOf(...Object.keys(rules).map(k => literalOf(k)))\n\n/**\n *\n * @example ('disagreement', 2, 1) => 2\n * @example ('disagreement', 5, 1) => 3\n * @example ('disagreement', 7, 10) => 7\n * @example ('disagreement', 20, 10) => 10\n *\n * @example ('percentage', 0.5, 3) => 0.5\n * @example ('percentage', 0.1, 3) => 0.33\n * @example ('percentage', 0.1, 10) => 0.2\n * @example ('percentage', 0.3, 10) => 0.3\n */\nexport const getThresholdAdjusted = (rule        , threshold        , groupSize        )         => {\n  const groupSizeVoting = Math.max(3, groupSize) // 3 = minimum groupSize to vote\n\n  return {\n    [RULE_DISAGREEMENT]: () => {\n      // Limit number of maximum \"no\" votes to group size\n      return Math.min(groupSizeVoting - 1, threshold)\n    },\n    [RULE_PERCENTAGE]: () => {\n      // Minimum threshold correspondent to 2 \"yes\" votes\n      const minThreshold = 2 / groupSizeVoting\n      return Math.max(minThreshold, threshold)\n    }\n  }[rule]()\n}\n\n/**\n *\n * @example (10, 0.5) => 5\n * @example (3, 0.8) => 3\n * @example (1, 0.6) => 2\n */\nexport const getCountOutOfMembers = (groupSize        , decimal        )         => {\n  const minGroupSize = 3 // when group can vote\n  return Math.ceil(Math.max(minGroupSize, groupSize) * decimal)\n}\n\nexport const getPercentFromDecimal = (decimal        )         => {\n  // convert decimal to percentage avoiding weird decimals results.\n  // e.g. 0.58 -> 58 instead of 57.99999\n  return Math.round(decimal * 100)\n}\n", "'use strict'\n\nimport { L } from '@common/common.js'\n\nexport const MINS_MILLIS = 60000\nexport const HOURS_MILLIS = 60 * MINS_MILLIS\nexport const DAYS_MILLIS = 24 * HOURS_MILLIS\nexport const MONTHS_MILLIS = 30 * DAYS_MILLIS\n\nexport function addMonthsToDate (date        , months        )       {\n  const now = new Date(date)\n  return new Date(now.setMonth(now.getMonth() + months))\n}\n\n// It might be tempting to deal directly with Dates and ISOStrings, since that's basically\n// what a period stamp is at the moment, but keeping this abstraction allows us to change\n// our mind in the future simply by editing these two functions.\n// TODO: We may want to, for example, get the time from the server instead of relying on\n// the client in case the client's clock isn't set correctly.\n// See: https://github.com/okTurtles/group-income/issues/531\nexport function dateToPeriodStamp (date               )         {\n  return new Date(date).toISOString()\n}\n\nexport function dateFromPeriodStamp (daystamp        )       {\n  return new Date(daystamp)\n}\n\nexport function periodStampGivenDate ({ recentDate, periodStart, periodLength }   \n                                                               \n )         {\n  const periodStartDate = dateFromPeriodStamp(periodStart)\n  let nextPeriod = addTimeToDate(periodStartDate, periodLength)\n  const curDate = new Date(recentDate)\n  let curPeriod\n  if (curDate < nextPeriod) {\n    if (curDate >= periodStartDate) {\n      return periodStart // we're still in the same period\n    } else {\n      // we're in a period before the current one\n      curPeriod = periodStartDate\n      do {\n        curPeriod = addTimeToDate(curPeriod, -periodLength)\n      } while (curDate < curPeriod)\n    }\n  } else {\n    // we're at least a period ahead of periodStart\n    do {\n      curPeriod = nextPeriod\n      nextPeriod = addTimeToDate(nextPeriod, periodLength)\n    } while (curDate >= nextPeriod)\n  }\n  return dateToPeriodStamp(curPeriod)\n}\n\nexport function dateIsWithinPeriod ({ date, periodStart, periodLength }   \n                                                         \n )          {\n  const dateObj = new Date(date)\n  const start = dateFromPeriodStamp(periodStart)\n  return dateObj > start && dateObj < addTimeToDate(start, periodLength)\n}\n\nexport function addTimeToDate (date               , timeMillis        )       {\n  const d = new Date(date)\n  d.setTime(d.getTime() + timeMillis)\n  return d\n}\n\nexport function dateToMonthstamp (date               )         {\n  // we could use Intl.DateTimeFormat but that doesn't support .format() on Android\n  // https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/DateTimeFormat/format\n  return new Date(date).toISOString().slice(0, 7)\n}\n\nexport function dateFromMonthstamp (monthstamp        )       {\n  // this is a hack to prevent new Date('2020-01').getFullYear() => 2019\n  return new Date(`${monthstamp}-01T00:01:00.000Z`) // the Z is important\n}\n\n// TODO: to prevent conflicts among user timezones, we need\n//       to use the server's time, and not our time here.\n//       https://github.com/okTurtles/group-income/issues/531\nexport function currentMonthstamp ()         {\n  return dateToMonthstamp(new Date())\n}\n\nexport function prevMonthstamp (monthstamp        )         {\n  const date = dateFromMonthstamp(monthstamp)\n  date.setMonth(date.getMonth() - 1)\n  return dateToMonthstamp(date)\n}\n\nexport function comparePeriodStamps (periodA        , periodB        )         {\n  return dateFromPeriodStamp(periodA).getTime() - dateFromPeriodStamp(periodB).getTime()\n}\n\nexport function compareMonthstamps (monthstampA        , monthstampB        )         {\n  return dateFromMonthstamp(monthstampA).getTime() - dateFromMonthstamp(monthstampB).getTime()\n  // const A = dateA.getMonth() + dateA.getFullYear() * 12\n  // const B = dateB.getMonth() + dateB.getFullYear() * 12\n  // return A - B\n}\n\nexport function compareISOTimestamps (a        , b        )         {\n  return new Date(a).getTime() - new Date(b).getTime()\n}\n\nexport function lastDayOfMonth (date      )       {\n  return new Date(date.getFullYear(), date.getMonth() + 1, 0)\n}\n\nexport function firstDayOfMonth (date      )       {\n  return new Date(date.getFullYear(), date.getMonth(), 1)\n}\n\nexport function humanDate (\n  date                        ,\n  options                              = { month: 'short', day: 'numeric' }\n)         {\n  const locale = typeof navigator === 'undefined'\n    // Fallback for Mocha tests.\n    ? 'en-US'\n    // Flow considers `navigator.languages` to be of type `$ReadOnlyArray<string>`,\n    // which is not compatible with the `string[]` expected by `.toLocaleDateString()`.\n    // Casting to `string[]` through `any` as a workaround.\n    : ((navigator.languages     )          ) ?? navigator.language\n  // NOTE: `.toLocaleDateString()` automatically takes local timezone differences into account.\n  // https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Date/toLocaleDateString\n  return new Date(date).toLocaleDateString(locale, options)\n}\n\nexport function isPeriodStamp (arg        )          {\n  return /\\d{4}-\\d{2}-\\d{2}T\\d{2}:\\d{2}:\\d{2}.\\d{3}Z/.test(arg)\n}\n\nexport function isFullMonthstamp (arg        )          {\n  return /^\\d{4}-(0[1-9]|1[0-2])$/.test(arg)\n}\n\nexport function isMonthstamp (arg        )          {\n  return isShortMonthstamp(arg) || isFullMonthstamp(arg)\n}\n\nexport function isShortMonthstamp (arg        )          {\n  return /^(0[1-9]|1[0-2])$/.test(arg)\n}\n\nexport function monthName (monthstamp        )         {\n  return humanDate(dateFromMonthstamp(monthstamp), { month: 'long' })\n}\n\nexport function proximityDate (date      )         {\n  date = new Date(date)\n  const today = new Date()\n  const yesterday = (d => new Date(d.setDate(d.getDate() - 1)))(new Date())\n  const lastWeek = (d => new Date(d.setDate(d.getDate() - 7)))(new Date())\n\n  for (const toReset of [date, today, yesterday, lastWeek]) {\n    toReset.setHours(0)\n    toReset.setMinutes(0)\n    toReset.setSeconds(0, 0)\n  }\n\n  const datems = Number(date)\n  let pd = date > lastWeek ? humanDate(datems, { month: 'short', day: 'numeric', year: 'numeric' }) : humanDate(datems)\n  if (date.getTime() === yesterday.getTime()) pd = L('Yesterday')\n  if (date.getTime() === today.getTime()) pd = L('Today')\n\n  return pd\n}\n\nexport function timeSince (datems        , dateNow         = Date.now())         {\n  const interval = dateNow - datems\n\n  if (interval >= DAYS_MILLIS * 2) {\n    // Make sure to replace any ordinary space character by a non-breaking one.\n    return humanDate(datems).replace(/\\x32/g, '\\xa0')\n  }\n  if (interval >= DAYS_MILLIS) {\n    return L('1d')\n  }\n  if (interval >= HOURS_MILLIS) {\n    return L('{hours}h', { hours: Math.floor(interval / HOURS_MILLIS) })\n  }\n  if (interval >= MINS_MILLIS) {\n    // Maybe use 'min' symbol rather than 'm'?\n    return L('{minutes}m', { minutes: Math.max(1, Math.floor(interval / MINS_MILLIS)) })\n  }\n  return L('<1m')\n}\n\nexport function cycleAtDate (atDate               )         {\n  const now = new Date(atDate) // Just in case the parameter is a string type.\n  const partialCycles = now.getDate() / lastDayOfMonth(now).getDate()\n  return partialCycles\n}\n", "'use strict'\n\nimport sbp from '@sbp/sbp'\nimport { Vue } from '@common/common.js'\nimport { objectOf, literalOf, unionOf, number } from '~/frontend/model/contracts/misc/flowTyper.js'\nimport { DAYS_MILLIS } from '../time.js'\nimport rules, { ruleType, VOTE_UNDECIDED, VOTE_AGAINST, VOTE_FOR, RULE_PERCENTAGE, RULE_DISAGREEMENT } from './rules.js'\nimport {\n  PROPOSAL_RESULT,\n  PROPOSAL_INVITE_MEMBER,\n  PROPOSAL_REMOVE_MEMBER,\n  PROPOSAL_GROUP_SETTING_CHANGE,\n  PROPOSAL_PROPOSAL_SETTING_CHANGE,\n  PROPOSAL_GENERIC,\n  // STATUS_OPEN,\n  STATUS_PASSED,\n  STATUS_FAILED\n  // STATUS_EXPIRED,\n  // STATUS_CANCELLED\n} from '../constants.js'\n\nexport function archiveProposal ({ state, proposalHash, proposal, contractID }) {\n  Vue.delete(state.proposals, proposalHash)\n  sbp('gi.contracts/group/pushSideEffect', contractID,\n    ['gi.contracts/group/archiveProposal', contractID, proposalHash, proposal]\n  )\n}\n\nexport function buildInvitationUrl (groupId        , inviteSecret        )         {\n  return `${location.origin}/app/join?groupId=${groupId}&secret=${inviteSecret}`\n}\n\nexport const proposalSettingsType      = objectOf({\n  rule: ruleType,\n  expires_ms: number,\n  ruleSettings: objectOf({\n    [RULE_PERCENTAGE]: objectOf({ threshold: number }),\n    [RULE_DISAGREEMENT]: objectOf({ threshold: number })\n  })\n})\n\n// returns true IF a single YES vote is required to pass the proposal\nexport function oneVoteToPass (proposalHash        )          {\n  const rootState = sbp('state/vuex/state')\n  const state = rootState[rootState.currentGroupId]\n  const proposal = state.proposals[proposalHash]\n  const votes = Object.assign({}, proposal.votes)\n  const currentResult = rules[proposal.data.votingRule](state, proposal.data.proposalType, votes)\n  votes[String(Math.random())] = VOTE_FOR\n  const newResult = rules[proposal.data.votingRule](state, proposal.data.proposalType, votes)\n  console.debug(`oneVoteToPass currentResult(${currentResult}) newResult(${newResult})`)\n\n  return currentResult === VOTE_UNDECIDED && newResult === VOTE_FOR\n}\n\nfunction voteAgainst (state     , { meta, data, contractID }     ) {\n  const { proposalHash } = data\n  const proposal = state.proposals[proposalHash]\n  proposal.status = STATUS_FAILED\n  sbp('okTurtles.events/emit', PROPOSAL_RESULT, state, VOTE_AGAINST, data)\n  archiveProposal({ state, proposalHash, proposal, contractID })\n}\n\n// NOTE: The code is ready to receive different proposals settings,\n// However, we decided to make all settings the same, to simplify the UI/UX proptotype.\nexport const proposalDefaults = {\n  rule: RULE_PERCENTAGE,\n  expires_ms: 14 * DAYS_MILLIS,\n  ruleSettings: ({\n    [RULE_PERCENTAGE]: { threshold: 0.66 },\n    [RULE_DISAGREEMENT]: { threshold: 1 }\n  }                                                                            )\n}\n\nconst proposals         = {\n  [PROPOSAL_INVITE_MEMBER]: {\n    defaults: proposalDefaults,\n    [VOTE_FOR]: function (state, { meta, data, contractID }) {\n      const { proposalHash } = data\n      const proposal = state.proposals[proposalHash]\n      proposal.payload = data.passPayload\n      proposal.status = STATUS_PASSED\n      // NOTE: if invite/process requires more than just data+meta\n      //       this code will need to be updated...\n      const message = { meta, data: data.passPayload, contractID }\n      sbp('gi.contracts/group/invite/process', message, state)\n      sbp('okTurtles.events/emit', PROPOSAL_RESULT, state, VOTE_FOR, data)\n      archiveProposal({ state, proposalHash, proposal, contractID })\n      // TODO: for now, generate the link and send it to the user's inbox\n      //       however, we cannot send GIMessages in any way from here\n      //       because that means each time someone synchronizes this contract\n      //       a new invite would be sent...\n      //       which means the voter who casts the deciding ballot needs to\n      //       include in this message the authorization for the new user to\n      //       join the group.\n      //       we could make it so that all users generate the same authorization\n      //       somehow...\n      //       however if it's an OP_KEY_* message ther can only be one of those!\n      //\n      //       so, the deciding voter is the one that generates the passPayload data for the\n      //       link includes the OP_KEY_* message in their final vote authorizing\n      //       the user.\n      //       additionally, for our testing purposes, we check to see if the\n      //       currently logged in user is the deciding voter, and if so we\n      //       send a message to that user's inbox with the link. The user\n      //       clicks the link and then generates an invite accept or invite decline message.\n      //\n      //       we no longer have a state.invitees, instead we have a state.invites\n      // sbp('okTurtles.events/emit', PROPOSAL_RESULT, state, VOTE_FOR, data)\n      // TODO: generate and save invite link, which is used to generate a group/inviteAccept message\n      //       the invite link contains the secret to a public/private keypair that is generated\n      //       by the final voter, this keypair is a special \"write only\" keypair that is allowed\n      //       to only send a single kind of message to the group (accepting the invite, deleting\n      //       the writeonly keypair, and registering a new keypair with the group that has\n      //       full member privileges, i.e. their identity contract). The writeonly keypair\n      //       that's registered originally also contains attributes that tell the server\n      //       what kind of message(s) it's allowed to send to the contract, and how many\n      //       of them.\n    },\n    [VOTE_AGAINST]: voteAgainst\n  },\n  [PROPOSAL_REMOVE_MEMBER]: {\n    defaults: proposalDefaults,\n    [VOTE_FOR]: function (state, { meta, data, contractID }) {\n      const { proposalHash, passPayload } = data\n      const proposal = state.proposals[proposalHash]\n      proposal.status = STATUS_PASSED\n      proposal.payload = passPayload\n      const messageData = {\n        ...proposal.data.proposalData,\n        proposalHash,\n        proposalPayload: passPayload\n      }\n      const message = { data: messageData, meta, contractID }\n      sbp('gi.contracts/group/removeMember/process', message, state)\n      sbp('gi.contracts/group/pushSideEffect', contractID,\n        ['gi.contracts/group/removeMember/sideEffect', message]\n      )\n      archiveProposal({ state, proposalHash, proposal, contractID })\n    },\n    [VOTE_AGAINST]: voteAgainst\n  },\n  [PROPOSAL_GROUP_SETTING_CHANGE]: {\n    defaults: proposalDefaults,\n    [VOTE_FOR]: function (state, { meta, data, contractID }) {\n      const { proposalHash } = data\n      const proposal = state.proposals[proposalHash]\n      proposal.status = STATUS_PASSED\n      const { setting, proposedValue } = proposal.data.proposalData\n      // NOTE: if updateSettings ever needs more ethana just meta+data\n      //       this code will need to be updated\n      const message = {\n        meta,\n        data: { [setting]: proposedValue },\n        contractID\n      }\n      sbp('gi.contracts/group/updateSettings/process', message, state)\n      archiveProposal({ state, proposalHash, proposal, contractID })\n    },\n    [VOTE_AGAINST]: voteAgainst\n  },\n  [PROPOSAL_PROPOSAL_SETTING_CHANGE]: {\n    defaults: proposalDefaults,\n    [VOTE_FOR]: function (state, { meta, data, contractID }) {\n      const { proposalHash } = data\n      const proposal = state.proposals[proposalHash]\n      proposal.status = STATUS_PASSED\n      const message = {\n        meta,\n        data: proposal.data.proposalData,\n        contractID\n      }\n      sbp('gi.contracts/group/updateAllVotingRules/process', message, state)\n      archiveProposal({ state, proposalHash, proposal, contractID })\n    },\n    [VOTE_AGAINST]: voteAgainst\n  },\n  [PROPOSAL_GENERIC]: {\n    defaults: proposalDefaults,\n    [VOTE_FOR]: function (state, { meta, data, contractID }) {\n      const { proposalHash } = data\n      const proposal = state.proposals[proposalHash]\n      proposal.status = STATUS_PASSED\n      sbp('okTurtles.events/emit', PROPOSAL_RESULT, state, VOTE_FOR, data)\n      archiveProposal({ state, proposalHash, proposal, contractID })\n    },\n    [VOTE_AGAINST]: voteAgainst\n  }\n}\n\nexport default proposals\n\nexport const proposalType      = unionOf(...Object.keys(proposals).map(k => literalOf(k)))\n", "'use strict'\n\nimport { unionOf, literalOf } from '~/frontend/model/contracts/misc/flowTyper.js'\n\nexport const PAYMENT_PENDING = 'pending'\nexport const PAYMENT_CANCELLED = 'cancelled'\nexport const PAYMENT_ERROR = 'error'\nexport const PAYMENT_NOT_RECEIVED = 'not-received'\nexport const PAYMENT_COMPLETED = 'completed'\nexport const paymentStatusType         = unionOf(...[PAYMENT_PENDING, PAYMENT_CANCELLED, PAYMENT_ERROR, PAYMENT_NOT_RECEIVED, PAYMENT_COMPLETED].map(k => literalOf(k)))\nexport const PAYMENT_TYPE_MANUAL = 'manual'\nexport const PAYMENT_TYPE_BITCOIN = 'bitcoin'\nexport const PAYMENT_TYPE_PAYPAL = 'paypal'\nexport const paymentType         = unionOf(...[PAYMENT_TYPE_MANUAL, PAYMENT_TYPE_BITCOIN, PAYMENT_TYPE_PAYPAL].map(k => literalOf(k)))\n", "'use strict'\n\n                              \n               \n                  \n \n\nexport default function mincomeProportional (haveNeeds                       )                {\n  let totalHave = 0\n  let totalNeed = 0\n  const havers = []\n  const needers = []\n  for (const haveNeed of haveNeeds) {\n    if (haveNeed.haveNeed > 0) {\n      havers.push(haveNeed)\n      totalHave += haveNeed.haveNeed\n    } else if (haveNeed.haveNeed < 0) {\n      needers.push(haveNeed)\n      totalNeed += Math.abs(haveNeed.haveNeed)\n    }\n  }\n  const totalPercent = Math.min(1, totalNeed / totalHave)\n  const payments = []\n  for (const haver of havers) {\n    const distributionAmount = totalPercent * haver.haveNeed\n    for (const needer of needers) {\n      const belowPercentage = Math.abs(needer.haveNeed) / totalNeed\n      payments.push({\n        amount: distributionAmount * belowPercentage,\n        from: haver.name,\n        to: needer.name\n      })\n    }\n  }\n  return payments\n}\n", "'use strict'\n\n// greedy algorithm responsible for \"balancing\" payments\n// such that the least number of payments are made.\nexport default function minimizeTotalPaymentsCount (\n  distribution               \n)                                                            {\n  const neederTotalReceived = {}\n  const haverTotalHave = {}\n  const haversSorted = []\n  const needersSorted = []\n  const minimizedDistribution = []\n  for (const todo of distribution) {\n    neederTotalReceived[todo.to] = (neederTotalReceived[todo.to] || 0) + todo.amount\n    haverTotalHave[todo.from] = (haverTotalHave[todo.from] || 0) + todo.amount\n  }\n  for (const name in haverTotalHave) {\n    haversSorted.push({ name, amount: haverTotalHave[name] })\n  }\n  for (const name in neederTotalReceived) {\n    needersSorted.push({ name, amount: neederTotalReceived[name] })\n  }\n  // sort haves and needs: greatest to least\n  haversSorted.sort((a, b) => b.amount - a.amount)\n  needersSorted.sort((a, b) => b.amount - a.amount)\n  while (haversSorted.length > 0 && needersSorted.length > 0) {\n    const mostHaver = haversSorted.pop()\n    const mostNeeder = needersSorted.pop()\n    const diff = mostHaver.amount - mostNeeder.amount\n    if (diff < 0) {\n      // we used up everything the haver had\n      minimizedDistribution.push({ amount: mostHaver.amount, from: mostHaver.name, to: mostNeeder.name })\n      mostNeeder.amount -= mostHaver.amount\n      needersSorted.push(mostNeeder)\n    } else if (diff > 0) {\n      // we completely filled up the needer's need and still have some left over\n      minimizedDistribution.push({ amount: mostNeeder.amount, from: mostHaver.name, to: mostNeeder.name })\n      mostHaver.amount -= mostNeeder.amount\n      haversSorted.push(mostHaver)\n    } else {\n      // a perfect match\n      minimizedDistribution.push({ amount: mostNeeder.amount, from: mostHaver.name, to: mostNeeder.name })\n    }\n  }\n  return minimizedDistribution\n}\n", "'use strict'\n\n                  \n                      \n                                         \n                                            \n                 \n                         \n                               \n  \n\n// https://github.com/okTurtles/group-income/issues/813#issuecomment-593680834\n// round all accounting to DECIMALS_MAX decimal places max to avoid consensus\n// issues that can arise due to different floating point values\n// at extreme precisions. If this becomes inadequate, instead of increasing\n// this value, switch to a different currency base, e.g. from BTC to mBTC.\nexport const DECIMALS_MAX = 8\n\nfunction commaToDots (value                 )         {\n  // ex: \"1,55\" -> \"1.55\"\n  return typeof value === 'string' ? value.replace(/,/, '.') : value.toString()\n}\n\nfunction isNumeric (nr        )          {\n  return !isNaN((nr     ) - parseFloat(nr))\n}\n\nfunction isInDecimalsLimit (nr        , decimalsMax        ) {\n  const decimals = nr.split('.')[1]\n  return !decimals || decimals.length <= decimalsMax\n}\n\n// NOTE: Unsure whether this is *always* string; it comes from 'validators' in other files\nfunction validateMincome (value        , decimalsMax        ) {\n  const nr = commaToDots(value)\n  return isNumeric(nr) && isInDecimalsLimit(nr, decimalsMax)\n}\n\nfunction decimalsOrInt (num        , decimalsMax        )         {\n  // ex: 12.5 -> \"12.50\", but 250 -> \"250\"\n  return num.toFixed(decimalsMax).replace(/\\.0+$/, '')\n}\n\nexport function saferFloat (value        )         {\n  // ex: 1.333333333333333333 -> 1.33333333\n  return parseFloat(value.toFixed(DECIMALS_MAX))\n}\n\nexport function normalizeCurrency (value        )         {\n  // ex: \"1,333333333333333333\" -> 1.33333333\n  return saferFloat(parseFloat(commaToDots(value)))\n}\n\n// NOTE: Unsure whether this is *always* string; it comes from 'validators' in other files\nexport function mincomePositive (value        )          {\n  return parseFloat(commaToDots(value)) > 0\n}\n\nfunction makeCurrency (options)           {\n  const { symbol, symbolWithCode, decimalsMax, formatCurrency } = options\n  return {\n    symbol,\n    symbolWithCode,\n    decimalsMax,\n    displayWithCurrency: (n        ) => formatCurrency(decimalsOrInt(n, decimalsMax)),\n    displayWithoutCurrency: (n        ) => decimalsOrInt(n, decimalsMax),\n    validate: (n        ) => validateMincome(n, decimalsMax)\n  }\n}\n\n// NOTE: if we needed for some reason, this could also be defined in\n//       a json file that's read in and generates this object. For\n//       example, that would allow the addition of currencies without\n//       having to \"recompile\" a new version of the app.\nconst currencies                         = {\n  USD: makeCurrency({\n    symbol: '$',\n    symbolWithCode: '$ USD',\n    decimalsMax: 2,\n    formatCurrency: amount => '$' + amount\n  }),\n  EUR: makeCurrency({\n    symbol: '\u20AC',\n    symbolWithCode: '\u20AC EUR',\n    decimalsMax: 2,\n    formatCurrency: amount => '\u20AC' + amount\n  }),\n  BTC: makeCurrency({\n    symbol: '\u0243',\n    symbolWithCode: '\u0243 BTC',\n    decimalsMax: DECIMALS_MAX,\n    formatCurrency: amount => amount + '\u0243'\n  })\n}\n\nexport default currencies\n", "'use strict'\n\nimport mincomeProportional from './mincome-proportional.js'\nimport minimizeTotalPaymentsCount from './payments-minimizer.js'\nimport { cloneDeep } from '../giLodash.js'\nimport { saferFloat, DECIMALS_MAX } from '../currencies.js'\n\n                                  \n\nconst tinyNum = 1 / Math.pow(10, DECIMALS_MAX)\n\nexport function unadjustedDistribution ({ haveNeeds = [], minimize = true }   \n                                              \n )               {\n  const distribution = mincomeProportional(haveNeeds)\n  return minimize ? minimizeTotalPaymentsCount(distribution) : distribution\n}\n\nexport function adjustedDistribution (\n  { distribution, payments, dueOn }                                                                       \n)               {\n  distribution = cloneDeep(distribution)\n  // ensure the total is set because of how reduceDistribution works\n  for (const todo of distribution) {\n    todo.total = todo.amount\n  }\n  distribution = subtractDistributions(distribution, payments)\n    // remove any todos for containing miniscule amounts\n    // and pledgers who switched sides should have their todos removed\n    .filter(todo => todo.amount >= tinyNum)\n  for (const todo of distribution) {\n    todo.amount = saferFloat(todo.amount)\n    todo.total = saferFloat(todo.total)\n    todo.partial = todo.total !== todo.amount\n    todo.isLate = false\n    todo.dueOn = dueOn\n  }\n  // TODO: add in latePayments to the end of the distribution\n  //       consider passing in latePayments\n  return distribution\n}\n\n// Merges multiple payments between any combinations two of users:\nfunction reduceDistribution (payments              )               {\n  // Don't modify the payments list/object parameter in-place, as this is not intended:\n  payments = cloneDeep(payments)\n  for (let i = 0; i < payments.length; i++) {\n    const paymentA = payments[i]\n    for (let j = i + 1; j < payments.length; j++) {\n      const paymentB = payments[j]\n\n      // Were paymentA and paymentB between the same two users?\n      if ((paymentA.from === paymentB.from && paymentA.to === paymentB.to) ||\n        (paymentA.to === paymentB.from && paymentA.from === paymentB.to)) {\n        // Add or subtract paymentB's amount to paymentA's amount, depending on the relative\n        // direction of the two payments:\n        paymentA.amount += (paymentA.from === paymentB.from ? 1 : -1) * paymentB.amount\n        paymentA.total += (paymentA.from === paymentB.from ? 1 : -1) * paymentB.total\n        // Remove paymentB from payments, and decrement the inner sentinal loop variable:\n        payments.splice(j, 1)\n        j--\n      }\n    }\n  }\n  return payments\n}\n\nfunction addDistributions (paymentsA              , paymentsB              )               {\n  return reduceDistribution([...paymentsA, ...paymentsB])\n}\n\nfunction subtractDistributions (paymentsA              , paymentsB              )               {\n  // Don't modify any payment list/objects parameters in-place, as this is not intended:\n  paymentsB = cloneDeep(paymentsB)\n  // Reverse the sign of the second operand's amounts so that the final addition is actually subtraction:\n  for (const p of paymentsB) {\n    p.amount *= -1\n    p.total *= -1\n  }\n  return addDistributions(paymentsA, paymentsB)\n}\n", "'use strict'\n\nimport {\n  objectOf, objectMaybeOf, arrayOf, unionOf,\n  string, number, optional, mapOf, literalOf\n} from '~/frontend/model/contracts/misc/flowTyper.js'\nimport {\n  CHATROOM_TYPES, CHATROOM_PRIVACY_LEVEL,\n  MESSAGE_TYPES, MESSAGE_NOTIFICATIONS,\n  MAIL_TYPE_MESSAGE, MAIL_TYPE_FRIEND_REQ\n} from './constants.js'\n\n// group.js related\n\nexport const inviteType      = objectOf({\n  inviteSecret: string,\n  quantity: number,\n  creator: string,\n  invitee: optional(string),\n  status: string,\n  responses: mapOf(string, string),\n  expires: number\n})\n\n// chatroom.js related\n\nexport const chatRoomAttributesType      = objectOf({\n  name: string,\n  description: string,\n  type: unionOf(...Object.values(CHATROOM_TYPES).map(v => literalOf(v))),\n  privacyLevel: unionOf(...Object.values(CHATROOM_PRIVACY_LEVEL).map(v => literalOf(v)))\n})\n\nexport const messageType      = objectMaybeOf({\n  type: unionOf(...Object.values(MESSAGE_TYPES).map(v => literalOf(v))),\n  text: string, // message text | proposalId when type is INTERACTIVE | notificationType when type if NOTIFICATION\n  notification: objectMaybeOf({\n    type: unionOf(...Object.values(MESSAGE_NOTIFICATIONS).map(v => literalOf(v))),\n    params: mapOf(string, string) // { username }\n  }),\n  replyingMessage: objectOf({\n    id: string, // scroll to the original message and highlight\n    text: string // display text(if too long, truncate)\n  }),\n  emoticons: mapOf(string, arrayOf(string)), // mapping of emoticons and usernames\n  onlyVisibleTo: arrayOf(string) // list of usernames, only necessary when type is NOTIFICATION\n  // TODO: need to consider POLL and add more down here\n})\n\n// mailbox.js related\n\nexport const mailType      = unionOf(...[MAIL_TYPE_MESSAGE, MAIL_TYPE_FRIEND_REQ].map(k => literalOf(k)))\n", "'use strict'\n\nimport sbp from '@sbp/sbp'\nimport { Vue, Errors, L } from '@common/common.js'\nimport votingRules, { ruleType, VOTE_FOR, VOTE_AGAINST, RULE_PERCENTAGE, RULE_DISAGREEMENT } from './shared/voting/rules.js'\nimport proposals, { proposalType, proposalSettingsType, archiveProposal } from './shared/voting/proposals.js'\nimport {\n  PROPOSAL_INVITE_MEMBER, PROPOSAL_REMOVE_MEMBER, PROPOSAL_GROUP_SETTING_CHANGE, PROPOSAL_PROPOSAL_SETTING_CHANGE, PROPOSAL_GENERIC, STATUS_OPEN, STATUS_CANCELLED, MAX_ARCHIVED_PROPOSALS, PROPOSAL_ARCHIVED,\n  INVITE_INITIAL_CREATOR, INVITE_STATUS, PROFILE_STATUS, INVITE_EXPIRES_IN_DAYS\n} from './shared/constants.js'\nimport { paymentStatusType, paymentType, PAYMENT_COMPLETED } from './shared/payments/index.js'\nimport { merge, deepEqualJSONType, omit } from './shared/giLodash.js'\nimport { addTimeToDate, dateToPeriodStamp, compareISOTimestamps, dateFromPeriodStamp, isPeriodStamp, comparePeriodStamps, periodStampGivenDate, dateIsWithinPeriod, DAYS_MILLIS } from './shared/time.js'\nimport { unadjustedDistribution, adjustedDistribution } from './shared/distribution/distribution.js'\nimport currencies, { saferFloat } from './shared/currencies.js'\nimport { inviteType, chatRoomAttributesType } from './shared/types.js'\nimport { arrayOf, mapOf, objectOf, objectMaybeOf, optional, string, number, boolean, object, unionOf, tupleOf } from '~/frontend/model/contracts/misc/flowTyper.js'\n\nfunction vueFetchInitKV (obj        , key        , initialValue     )      {\n  let value = obj[key]\n  if (!value) {\n    Vue.set(obj, key, initialValue)\n    value = obj[key]\n  }\n  return value\n}\n\nfunction initGroupProfile (contractID        , joinedDate        ) {\n  return {\n    globalUsername: '', // TODO: this? e.g. groupincome:greg / namecoin:bob / ens:alice\n    contractID,\n    joinedDate,\n    nonMonetaryContributions: [],\n    status: PROFILE_STATUS.ACTIVE,\n    departedDate: null\n  }\n}\n\nfunction initPaymentPeriod ({ getters }) {\n  return {\n    // this saved so that it can be used when creating a new payment\n    initialCurrency: getters.groupMincomeCurrency,\n    // TODO: should we also save the first period's currency exchange rate..?\n    // all payments during the period use this to set their exchangeRate\n    // see notes and code in groupIncomeAdjustedDistribution for details.\n    // TODO: for the currency change proposal, have it update the mincomeExchangeRate\n    //       using .mincomeExchangeRate *= proposal.exchangeRate\n    mincomeExchangeRate: 1, // modified by proposals to change mincome currency\n    paymentsFrom: {}, // fromUser => toUser => Array<paymentHash>\n    // snapshot of adjusted distribution after each completed payment\n    // yes, it is possible a payment began in one period and completed in another\n    // in which case lastAdjustedDistribution for the previous period will be updated\n    lastAdjustedDistribution: null,\n    // snapshot of haveNeeds. made only when there are no payments\n    haveNeedsSnapshot: null\n  }\n}\n\n// NOTE: do not call any of these helper functions from within a getter b/c they modify state!\n\nfunction clearOldPayments ({ state, getters }) {\n  const sortedPeriodKeys = Object.keys(state.paymentsByPeriod).sort()\n  // save two periods worth of payments, max\n  while (sortedPeriodKeys.length > 2) {\n    const period = sortedPeriodKeys.shift()\n    for (const paymentHash of getters.paymentHashesForPeriod(period)) {\n      Vue.delete(state.payments, paymentHash)\n      // TODO: archive the old payments in a sideEffect, not here\n    }\n    Vue.delete(state.paymentsByPeriod, period)\n  }\n}\n\nfunction initFetchPeriodPayments ({ meta, state, getters }) {\n  const period = getters.periodStampGivenDate(meta.createdDate)\n  const periodPayments = vueFetchInitKV(state.paymentsByPeriod, period, initPaymentPeriod({ getters }))\n  clearOldPayments({ state, getters })\n  return periodPayments\n}\n\n// this function is called each time a payment is completed or a user adjusts their income details.\n// TODO: call also when mincome is adjusted\nfunction updateCurrentDistribution ({ meta, state, getters }) {\n  const curPeriodPayments = initFetchPeriodPayments({ meta, state, getters })\n  const period = getters.periodStampGivenDate(meta.createdDate)\n  const noPayments = Object.keys(curPeriodPayments.paymentsFrom).length === 0\n  // update distributionDate if we've passed into the next period\n  if (comparePeriodStamps(period, getters.groupSettings.distributionDate) > 0) {\n    getters.groupSettings.distributionDate = period\n  }\n  // save haveNeeds if there are no payments or the haveNeeds haven't been saved yet\n  if (noPayments || !curPeriodPayments.haveNeedsSnapshot) {\n    curPeriodPayments.haveNeedsSnapshot = getters.haveNeedsForThisPeriod(period)\n  }\n  // if there are payments this period, save the adjusted distribution\n  if (!noPayments) {\n    updateAdjustedDistribution({ period, getters })\n  }\n}\n\nfunction updateAdjustedDistribution ({ period, getters }) {\n  const payments = getters.groupPeriodPayments[period]\n  if (payments && payments.haveNeedsSnapshot) {\n    const minimize = getters.groupSettings.minimizeDistribution\n    payments.lastAdjustedDistribution = adjustedDistribution({\n      distribution: unadjustedDistribution({ haveNeeds: payments.haveNeedsSnapshot, minimize }),\n      payments: getters.paymentsForPeriod(period),\n      dueOn: getters.dueDateForPeriod(period)\n    }).filter(todo => {\n      // only return todos for active members\n      return getters.groupProfile(todo.to).status === PROFILE_STATUS.ACTIVE\n    })\n  }\n}\n\nfunction memberLeaves ({ username, dateLeft }, { meta, state, getters }) {\n  state.profiles[username].status = PROFILE_STATUS.REMOVED\n  state.profiles[username].departedDate = dateLeft\n  // remove any todos for this member from the adjusted distribution\n  updateCurrentDistribution({ meta, state, getters })\n}\n\nfunction isActionYoungerThanUser (actionMeta        , userProfile         )          {\n  // A util function that checks if an action (or event) in a group occurred after a particular user joined a group.\n  // This is used mostly for checking if a notification should be sent for that user or not.\n  // e.g.) user-2 who joined a group later than user-1 (who is the creator of the group) doesn't need to receive\n  // 'MEMBER_ADDED' notification for user-1.\n  // In some situations, userProfile is undefined, for example, when inviteAccept is called in\n  // certain situations. So we need to check for that here.\n  return Boolean(userProfile) && compareISOTimestamps(actionMeta.createdDate, userProfile.joinedDate) > 0\n}\n\nsbp('chelonia/defineContract', {\n  name: 'gi.contracts/group',\n  metadata: {\n    validate: objectOf({\n      createdDate: string,\n      username: string,\n      identityContractID: string\n    }),\n    create () {\n      const { username, identityContractID } = sbp('state/vuex/state').loggedIn\n      return {\n        // TODO: We may want to get the time from the server instead of relying on\n        // the client in case the client's clock isn't set correctly.\n        // the only issue here is that it involves an async function...\n        // See: https://github.com/okTurtles/group-income/issues/531\n        createdDate: new Date().toISOString(),\n        username,\n        identityContractID\n      }\n    }\n  },\n  // These getters are restricted only to the contract's state.\n  // Do not access state outside the contract state inside of them.\n  // For example, if the getter you use tries to access `state.loggedIn`,\n  // that will break the `latestContractState` function in state.js.\n  // It is only safe to access state outside of the contract in a contract action's\n  // `sideEffect` function (as long as it doesn't modify contract state)\n  getters: {\n    // we define `currentGroupState` here so that we can redefine it in state.js\n    // so that we can re-use these getter definitions in state.js since they are\n    // compatible with Vuex getter definitions.\n    // Here `state` refers to the individual group contract's state, the equivalent\n    // of `vuexRootState[someGroupContractID]`.\n    currentGroupState (state) {\n      return state\n    },\n    groupSettings (state, getters) {\n      return getters.currentGroupState.settings || {}\n    },\n    groupProfile (state, getters) {\n      return username => {\n        const profiles = getters.currentGroupState.profiles\n        return profiles && profiles[username]\n      }\n    },\n    groupProfiles (state, getters) {\n      const profiles = {}\n      for (const username in (getters.currentGroupState.profiles || {})) {\n        const profile = getters.groupProfile(username)\n        if (profile.status === PROFILE_STATUS.ACTIVE) {\n          profiles[username] = profile\n        }\n      }\n      return profiles\n    },\n    groupMincomeAmount (state, getters) {\n      return getters.groupSettings.mincomeAmount\n    },\n    groupMincomeCurrency (state, getters) {\n      return getters.groupSettings.mincomeCurrency\n    },\n    periodStampGivenDate (state, getters) {\n      return (recentDate               ) => {\n        if (typeof recentDate !== 'string') {\n          recentDate = recentDate.toISOString()\n        }\n        const { distributionDate, distributionPeriodLength } = getters.groupSettings\n        return periodStampGivenDate({\n          recentDate,\n          periodStart: distributionDate,\n          periodLength: distributionPeriodLength\n        })\n      }\n    },\n    periodBeforePeriod (state, getters) {\n      return (periodStamp        ) => {\n        const len = getters.groupSettings.distributionPeriodLength\n        return dateToPeriodStamp(addTimeToDate(dateFromPeriodStamp(periodStamp), -len))\n      }\n    },\n    periodAfterPeriod (state, getters) {\n      return (periodStamp        ) => {\n        const len = getters.groupSettings.distributionPeriodLength\n        return dateToPeriodStamp(addTimeToDate(dateFromPeriodStamp(periodStamp), len))\n      }\n    },\n    dueDateForPeriod (state, getters) {\n      return (periodStamp        ) => {\n        return dateToPeriodStamp(\n          addTimeToDate(\n            dateFromPeriodStamp(getters.periodAfterPeriod(periodStamp)),\n            -DAYS_MILLIS\n          )\n        )\n      }\n    },\n    paymentTotalFromUserToUser (state, getters) {\n      return (fromUser, toUser, periodStamp) => {\n        const payments = getters.currentGroupState.payments\n        const periodPayments = getters.groupPeriodPayments\n        const { paymentsFrom, mincomeExchangeRate } = periodPayments[periodStamp] || {}\n        // NOTE: @babel/plugin-proposal-optional-chaining would come in super-handy\n        //       here, but I couldn't get it to work with our linter. :(\n        //       https://github.com/babel/babel-eslint/issues/511\n        const total = (((paymentsFrom || {})[fromUser] || {})[toUser] || []).reduce((a, hash) => {\n          const payment = payments[hash]\n          let { amount, exchangeRate, status } = payment.data\n          if (status !== PAYMENT_COMPLETED) {\n            return a\n          }\n          const paymentCreatedPeriodStamp = getters.periodStampGivenDate(payment.meta.createdDate)\n          // if this payment is from a previous period, then make sure to take into account\n          // any proposals that passed in between the payment creation and the payment\n          // completion that modified the group currency by multiplying both period's\n          // exchange rates\n          if (periodStamp !== paymentCreatedPeriodStamp) {\n            if (paymentCreatedPeriodStamp !== getters.periodBeforePeriod(periodStamp)) {\n              console.warn(`paymentTotalFromUserToUser: super old payment shouldn't exist, ignoring! (curPeriod=${periodStamp})`, JSON.stringify(payment))\n              return a\n            }\n            exchangeRate *= periodPayments[paymentCreatedPeriodStamp].mincomeExchangeRate\n          }\n          return a + (amount * exchangeRate * mincomeExchangeRate)\n        }, 0)\n        return saferFloat(total)\n      }\n    },\n    paymentHashesForPeriod (state, getters) {\n      return (periodStamp) => {\n        const periodPayments = getters.groupPeriodPayments[periodStamp]\n        if (periodPayments) {\n          let hashes = []\n          const { paymentsFrom } = periodPayments\n          for (const fromUser in paymentsFrom) {\n            for (const toUser in paymentsFrom[fromUser]) {\n              hashes = hashes.concat(paymentsFrom[fromUser][toUser])\n            }\n          }\n          return hashes\n        }\n      }\n    },\n    groupMembersByUsername (state, getters) {\n      return Object.keys(getters.groupProfiles)\n    },\n    groupMembersCount (state, getters) {\n      return getters.groupMembersByUsername.length\n    },\n    groupMembersPending (state, getters) {\n      const invites = getters.currentGroupState.invites\n      const pendingMembers = {}\n      for (const inviteId in invites) {\n        const invite = invites[inviteId]\n        if (\n          invite.status === INVITE_STATUS.VALID &&\n          invite.creator !== INVITE_INITIAL_CREATOR\n        ) {\n          pendingMembers[invites[inviteId].invitee] = {\n            invitedBy: invites[inviteId].creator,\n            expires: invite.expires\n          }\n        }\n      }\n      return pendingMembers\n    },\n    groupShouldPropose (state, getters) {\n      return getters.groupMembersCount >= 3\n    },\n    groupProposalSettings (state, getters) {\n      return (proposalType = PROPOSAL_GENERIC) => {\n        return getters.groupSettings.proposals[proposalType]\n      }\n    },\n    groupCurrency (state, getters) {\n      const mincomeCurrency = getters.groupMincomeCurrency\n      return mincomeCurrency && currencies[mincomeCurrency]\n    },\n    groupMincomeFormatted (state, getters) {\n      return getters.withGroupCurrency?.(getters.groupMincomeAmount)\n    },\n    groupMincomeSymbolWithCode (state, getters) {\n      return getters.groupCurrency?.symbolWithCode\n    },\n    groupPeriodPayments (state, getters)         {\n      // note: a lot of code expects this to return an object, so keep the || {} below\n      return getters.currentGroupState.paymentsByPeriod || {}\n    },\n    groupThankYousFrom (state, getters)         {\n      return getters.currentGroupState.thankYousFrom || {}\n    },\n    withGroupCurrency (state, getters) {\n      // TODO: If this group has no defined mincome currency, not even a default one like\n      //       USD, then calling this function is probably an error which should be reported.\n      //       Just make sure the UI doesn't break if an exception is thrown, since this is\n      //       bound to the UI in some location.\n      return getters.groupCurrency?.displayWithCurrency\n    },\n    getChatRooms (state, getters) {\n      return getters.currentGroupState.chatRooms\n    },\n    generalChatRoomId (state, getters) {\n      return getters.currentGroupState.generalChatRoomId\n    },\n    // getter is named haveNeedsForThisPeriod instead of haveNeedsForPeriod because it uses\n    // getters.groupProfiles - and that is always based on the most recent values. we still\n    // pass in the current period because it's used to set the \"when\" property\n    haveNeedsForThisPeriod (state, getters) {\n      return (currentPeriod        ) => {\n        // NOTE: if we ever switch back to the \"real-time\" adjusted distribution algorithm,\n        //       make sure that this function also handles userExitsGroupEvent\n        const groupProfiles = getters.groupProfiles // TODO: these should use the haveNeeds for the specific period's distribution period\n        const haveNeeds = []\n        for (const username in groupProfiles) {\n          const { incomeDetailsType, joinedDate } = groupProfiles[username]\n          if (incomeDetailsType) {\n            const amount = groupProfiles[username][incomeDetailsType]\n            const haveNeed = incomeDetailsType === 'incomeAmount' ? amount - getters.groupMincomeAmount : amount\n            // construct 'when' this way in case we ever use a pro-rated algorithm\n            let when = dateFromPeriodStamp(currentPeriod).toISOString()\n            if (dateIsWithinPeriod({\n              date: joinedDate,\n              periodStart: currentPeriod,\n              periodLength: getters.groupSettings.distributionPeriodLength\n            })) {\n              when = joinedDate\n            }\n            haveNeeds.push({ name: username, haveNeed, when })\n          }\n        }\n        return haveNeeds\n      }\n    },\n    paymentsForPeriod (state, getters) {\n      return (periodStamp) => {\n        const hashes = getters.paymentHashesForPeriod(periodStamp)\n        const events = []\n        if (hashes && hashes.length > 0) {\n          const payments = getters.currentGroupState.payments\n          for (const paymentHash of hashes) {\n            const payment = payments[paymentHash]\n            if (payment.data.status === PAYMENT_COMPLETED) {\n              events.push({\n                from: payment.meta.username,\n                to: payment.data.toUser,\n                hash: paymentHash,\n                amount: payment.data.amount,\n                isLate: !!payment.data.isLate,\n                when: payment.data.completedDate\n              })\n            }\n          }\n        }\n        return events\n      }\n    }\n    // distributionEventsForMonth (state, getters) {\n    //   return (monthstamp) => {\n    //     // NOTE: if we ever switch back to the \"real-time\" adjusted distribution\n    //     // algorithm, make sure that this function also handles userExitsGroupEvent\n    //     const distributionEvents = getters.haveNeedEventsForMonth(monthstamp)\n    //     const paymentEvents = getters.paymentEventsForMonth(monthstamp)\n    //     distributionEvents.splice(distributionEvents.length, 0, paymentEvents)\n    //     return distributionEvents.sort((a, b) => compareISOTimestamps(a.data.when, b.data.when))\n    //   }\n    // }\n  },\n  // NOTE: All mutations must be atomic in their edits of the contract state.\n  //       THEY ARE NOT to farm out any further mutations through the async actions!\n  actions: {\n    // this is the constructor\n    'gi.contracts/group': {\n      validate: objectMaybeOf({\n        invites: mapOf(string, inviteType),\n        settings: objectMaybeOf({\n          // TODO: add 'groupPubkey'\n          groupName: string,\n          groupPicture: string,\n          sharedValues: string,\n          mincomeAmount: number,\n          mincomeCurrency: string,\n          distributionDate: isPeriodStamp,\n          distributionPeriodLength: number,\n          minimizeDistribution: boolean,\n          proposals: objectOf({\n            [PROPOSAL_INVITE_MEMBER]: proposalSettingsType,\n            [PROPOSAL_REMOVE_MEMBER]: proposalSettingsType,\n            [PROPOSAL_GROUP_SETTING_CHANGE]: proposalSettingsType,\n            [PROPOSAL_PROPOSAL_SETTING_CHANGE]: proposalSettingsType,\n            [PROPOSAL_GENERIC]: proposalSettingsType\n          })\n        })\n      }),\n      process ({ data, meta }, { state, getters }) {\n        // TODO: checkpointing: https://github.com/okTurtles/group-income/issues/354\n        const initialState = merge({\n          payments: {},\n          paymentsByPeriod: {},\n          thankYousFrom: {}, // { fromUser1: { toUser1: msg1, toUser2: msg2, ... }, fromUser2: {}, ...  }\n          invites: {},\n          proposals: {}, // hashes => {} TODO: this, see related TODOs in GroupProposal\n          settings: {\n            groupCreator: meta.username,\n            distributionPeriodLength: 30 * DAYS_MILLIS,\n            inviteExpiryOnboarding: INVITE_EXPIRES_IN_DAYS.ON_BOARDING,\n            inviteExpiryProposal: INVITE_EXPIRES_IN_DAYS.PROPOSAL\n          },\n          profiles: {\n            [meta.username]: initGroupProfile(meta.identityContractID, meta.createdDate)\n          },\n          chatRooms: {}\n        }, data)\n        for (const key in initialState) {\n          Vue.set(state, key, initialState[key])\n        }\n        initFetchPeriodPayments({ meta, state, getters })\n      }\n    },\n    'gi.contracts/group/payment': {\n      validate: objectMaybeOf({\n        // TODO: how to handle donations to okTurtles?\n        // TODO: how to handle payments to groups or users outside of this group?\n        toUser: string,\n        amount: number,\n        currencyFromTo: tupleOf(string, string), // must be one of the keys in currencies.js (e.g. USD, EUR, etc.) TODO: handle old clients not having one of these keys, see OP_PROTOCOL_UPGRADE https://github.com/okTurtles/group-income/issues/603\n        // multiply 'amount' by 'exchangeRate', which must always be\n        // based on the initialCurrency of the period in which this payment was created.\n        // it is then further multiplied by the period's 'mincomeExchangeRate', which\n        // is modified if any proposals pass to change the mincomeCurrency\n        exchangeRate: number,\n        txid: string,\n        status: paymentStatusType,\n        paymentType: paymentType,\n        details: optional(object),\n        memo: optional(string)\n      }),\n      process ({ data, meta, hash }, { state, getters }) {\n        if (data.status === PAYMENT_COMPLETED) {\n          console.error(`payment: payment ${hash} cannot have status = 'completed'!`, { data, meta, hash })\n          throw new Errors.GIErrorIgnoreAndBan('payments cannot be instantly completed!')\n        }\n        Vue.set(state.payments, hash, {\n          data: {\n            ...data,\n            groupMincome: getters.groupMincomeAmount\n          },\n          meta,\n          history: [[meta.createdDate, hash]]\n        })\n        const { paymentsFrom } = initFetchPeriodPayments({ meta, state, getters })\n        const fromUser = vueFetchInitKV(paymentsFrom, meta.username, {})\n        const toUser = vueFetchInitKV(fromUser, data.toUser, [])\n        toUser.push(hash)\n        // TODO: handle completed payments here too! (for manual payment support)\n      }\n    },\n    'gi.contracts/group/paymentUpdate': {\n      validate: objectMaybeOf({\n        paymentHash: string,\n        updatedProperties: objectMaybeOf({\n          status: paymentStatusType,\n          details: object,\n          memo: string\n        })\n      }),\n      process ({ data, meta, hash }, { state, getters }) {\n        // TODO: we don't want to keep a history of all payments in memory all the time\n        //       https://github.com/okTurtles/group-income/issues/426\n        const payment = state.payments[data.paymentHash]\n        // TODO: move these types of validation errors into the validate function so\n        //       that they can be done before sending as well as upon receiving\n        if (!payment) {\n          console.error(`paymentUpdate: no payment ${data.paymentHash}`, { data, meta, hash })\n          throw new Errors.GIErrorIgnoreAndBan('paymentUpdate without existing payment')\n        }\n        // if the payment is being modified by someone other than the person who sent or received it, throw an exception\n        if (meta.username !== payment.meta.username && meta.username !== payment.data.toUser) {\n          console.error(`paymentUpdate: bad username ${meta.username} != ${payment.meta.username} != ${payment.data.username}`, { data, meta, hash })\n          throw new Errors.GIErrorIgnoreAndBan('paymentUpdate from bad user!')\n        }\n        payment.history.push([meta.createdDate, hash])\n        merge(payment.data, data.updatedProperties)\n        // we update \"this period\"'s snapshot 'lastAdjustedDistribution' on each completed payment\n        if (data.updatedProperties.status === PAYMENT_COMPLETED) {\n          payment.data.completedDate = meta.createdDate\n          // update the current distribution unless this update is for a payment from the previous period\n          const updatePeriodStamp = getters.periodStampGivenDate(meta.createdDate)\n          const paymentPeriodStamp = getters.periodStampGivenDate(payment.meta.createdDate)\n          if (comparePeriodStamps(updatePeriodStamp, paymentPeriodStamp) > 0) {\n            updateAdjustedDistribution({ period: paymentPeriodStamp, getters })\n          } else {\n            updateCurrentDistribution({ meta, state, getters })\n          }\n        }\n      },\n      sideEffect ({ meta, contractID, data }, { state, getters }) {\n        if (data.updatedProperties.status === PAYMENT_COMPLETED) {\n          const { loggedIn } = sbp('state/vuex/state')\n          const payment = state.payments[data.paymentHash]\n\n          if (loggedIn.username === payment.data.toUser) {\n            sbp('gi.notifications/emit', 'PAYMENT_RECEIVED', {\n              groupID: contractID,\n              creator: meta.username,\n              paymentHash: data.paymentHash,\n              amount: getters.withGroupCurrency(payment.data.amount)\n            })\n          }\n        }\n      }\n    },\n    'gi.contracts/group/sendPaymentThankYou': {\n      validate: objectOf({\n        fromUser: string,\n        toUser: string,\n        memo: string\n      }),\n      process ({ data }, { state }) {\n        const fromUser = vueFetchInitKV(state.thankYousFrom, data.fromUser, {})\n        Vue.set(fromUser, data.toUser, data.memo)\n      },\n      sideEffect ({ contractID, meta, data }) {\n        const { loggedIn } = sbp('state/vuex/state')\n\n        if (data.toUser === loggedIn.username) {\n          sbp('gi.notifications/emit', 'PAYMENT_THANKYOU_SENT', {\n            groupID: contractID,\n            creator: meta.username, // username of the from user. to be used with sbp('namespace/lookup') in 'AvatarUser.vue'\n            fromUser: data.fromUser, // display name of the from user\n            toUser: data.toUser\n          })\n        }\n      }\n    },\n    'gi.contracts/group/proposal': {\n      validate: (data, { state, meta }) => {\n        objectOf({\n          proposalType: proposalType,\n          proposalData: object, // data for Vue widgets\n          votingRule: ruleType,\n          expires_date_ms: number // calculate by grabbing proposal expiry from group properties and add to `meta.createdDate`\n        })(data)\n\n        const dataToCompare = omit(data.proposalData, ['reason'])\n\n        // Validate this isn't a duplicate proposal\n        for (const hash in state.proposals) {\n          const prop = state.proposals[hash]\n          if (prop.status !== STATUS_OPEN || prop.data.proposalType !== data.proposalType) {\n            continue\n          }\n\n          if (deepEqualJSONType(omit(prop.data.proposalData, ['reason']), dataToCompare)) {\n            throw new TypeError(L('There is an identical open proposal.'))\n          }\n\n          // TODO - verify if type of proposal already exists (SETTING_CHANGE).\n        }\n      },\n      process ({ data, meta, hash }, { state }) {\n        Vue.set(state.proposals, hash, {\n          data,\n          meta,\n          votes: { [meta.username]: VOTE_FOR },\n          status: STATUS_OPEN,\n          payload: null // set later by group/proposalVote\n        })\n        // TODO: save all proposals disk so that we only keep open proposals in memory\n        // TODO: create a global timer to auto-pass/archive expired votes\n        //       make sure to set that proposal's status as STATUS_EXPIRED if it's expired\n      },\n      sideEffect ({ contractID, meta, data }, { getters }) {\n        const { loggedIn } = sbp('state/vuex/state')\n        const typeToSubTypeMap = {\n          [PROPOSAL_INVITE_MEMBER]: 'ADD_MEMBER',\n          [PROPOSAL_REMOVE_MEMBER]: 'REMOVE_MEMBER',\n          [PROPOSAL_GROUP_SETTING_CHANGE]: 'CHANGE_MINCOME',\n          [PROPOSAL_PROPOSAL_SETTING_CHANGE]: 'CHANGE_VOTING_RULE',\n          [PROPOSAL_GENERIC]: 'GENERIC'\n        }\n\n        const myProfile = getters.groupProfile(loggedIn.username)\n\n        if (isActionYoungerThanUser(meta, myProfile)) {\n          sbp('gi.notifications/emit', 'NEW_PROPOSAL', {\n            groupID: contractID,\n            creator: meta.username,\n            subtype: typeToSubTypeMap[data.proposalType]\n          })\n        }\n      }\n    },\n    'gi.contracts/group/proposalVote': {\n      validate: objectOf({\n        proposalHash: string,\n        vote: string,\n        passPayload: optional(unionOf(object, string)) // TODO: this, somehow we need to send an OP_KEY_ADD GIMessage to add a generated once-only writeonly message public key to the contract, and (encrypted) include the corresponding invite link, also, we need all clients to verify that this message/operation was valid to prevent a hacked client from adding arbitrary OP_KEY_ADD messages, and automatically ban anyone generating such messages\n      }),\n      process (message, { state }) {\n        const { data, hash, meta } = message\n        const proposal = state.proposals[data.proposalHash]\n        if (!proposal) {\n          // https://github.com/okTurtles/group-income/issues/602\n          console.error(`proposalVote: no proposal for ${data.proposalHash}!`, { data, meta, hash })\n          throw new Errors.GIErrorIgnoreAndBan('proposalVote without existing proposal')\n        }\n        Vue.set(proposal.votes, meta.username, data.vote)\n        // TODO: handle vote pass/fail\n        // check if proposal is expired, if so, ignore (but log vote)\n        if (new Date(meta.createdDate).getTime() > proposal.data.expires_date_ms) {\n          console.warn('proposalVote: vote on expired proposal!', { proposal, data, meta })\n          // TODO: display warning or something\n          return\n        }\n        // see if this is a deciding vote\n        const result = votingRules[proposal.data.votingRule](state, proposal.data.proposalType, proposal.votes)\n        if (result === VOTE_FOR || result === VOTE_AGAINST) {\n          // handles proposal pass or fail, will update proposal.status accordingly\n          proposals[proposal.data.proposalType][result](state, message)\n          Vue.set(proposal, 'dateClosed', meta.createdDate)\n        }\n      },\n      sideEffect ({ contractID, data, meta }, { state, getters }) {\n        const proposal = state.proposals[data.proposalHash]\n        const { loggedIn } = sbp('state/vuex/state')\n        const myProfile = getters.groupProfile(loggedIn.username)\n\n        if (proposal?.dateClosed &&\n          isActionYoungerThanUser(meta, myProfile)) {\n          sbp('gi.notifications/emit', 'PROPOSAL_CLOSED', {\n            groupID: contractID,\n            creator: meta.username,\n            proposalStatus: proposal.status\n          })\n        }\n      }\n    },\n    'gi.contracts/group/proposalCancel': {\n      validate: objectOf({\n        proposalHash: string\n      }),\n      process ({ data, meta, contractID }, { state }) {\n        const proposal = state.proposals[data.proposalHash]\n        if (!proposal) {\n          // https://github.com/okTurtles/group-income/issues/602\n          console.error(`proposalCancel: no proposal for ${data.proposalHash}!`, { data, meta })\n          throw new Errors.GIErrorIgnoreAndBan('proposalVote without existing proposal')\n        } else if (proposal.meta.username !== meta.username) {\n          console.error(`proposalCancel: proposal ${data.proposalHash} belongs to ${proposal.meta.username} not ${meta.username}!`, { data, meta })\n          throw new Errors.GIErrorIgnoreAndBan('proposalWithdraw for wrong user!')\n        }\n        Vue.set(proposal, 'status', STATUS_CANCELLED)\n        archiveProposal({ state, proposalHash: data.proposalHash, proposal, contractID })\n      }\n    },\n    'gi.contracts/group/removeMember': {\n      validate: (data, { state, getters, meta }) => {\n        objectOf({\n          member: string, // username to remove\n          reason: optional(string),\n          automated: optional(boolean),\n          // In case it happens in a big group (by proposal)\n          // we need to validate the associated proposal.\n          proposalHash: optional(string),\n          proposalPayload: optional(objectOf({\n            secret: string // NOTE: simulate the OP_KEY_* stuff for now\n          }))\n        })(data)\n\n        const memberToRemove = data.member\n        const membersCount = getters.groupMembersCount\n\n        if (!state.profiles[memberToRemove]) {\n          throw new TypeError(L('Not part of the group.'))\n        }\n        if (membersCount === 1 || memberToRemove === meta.username) {\n          throw new TypeError(L('Cannot remove yourself.'))\n        }\n\n        if (membersCount < 3) {\n          // In a small group only the creator can remove someone\n          // TODO: check whether meta.username has required admin permissions\n          if (meta.username !== state.settings.groupCreator) {\n            throw new TypeError(L('Only the group creator can remove members.'))\n          }\n        } else {\n          // In a big group a removal can only happen through a proposal\n          const proposal = state.proposals[data.proposalHash]\n          if (!proposal) {\n            // TODO this\n            throw new TypeError(L('Admin credentials needed and not implemented yet.'))\n          }\n\n          if (!proposal.payload || proposal.payload.secret !== data.proposalPayload.secret) {\n            throw new TypeError(L('Invalid associated proposal.'))\n          }\n        }\n      },\n      process ({ data, meta }, { state, getters }) {\n        memberLeaves(\n          { username: data.member, dateLeft: meta.createdDate },\n          { meta, state, getters }\n        )\n      },\n      sideEffect ({ data, meta, contractID }, { state, getters }) {\n        const rootState = sbp('state/vuex/state')\n        const contracts = rootState.contracts || {}\n        const { username } = rootState.loggedIn\n\n        if (data.member === username) {\n          // If this member is re-joining the group, ignore the rest\n          // so the member doesn't remove themself again.\n          if (sbp('okTurtles.data/get', 'JOINING_GROUP')) {\n            return\n          }\n\n          const groupIdToSwitch = Object.keys(contracts)\n            .find(cID => contracts[cID].type === 'gi.contracts/group' &&\n              cID !== contractID && rootState[cID].settings) || null\n          sbp('state/vuex/commit', 'setCurrentChatRoomId', {})\n          sbp('state/vuex/commit', 'setCurrentGroupId', groupIdToSwitch)\n          // we can't await on this in here, because it will cause a deadlock, since Chelonia processes\n          // this sideEffect on the eventqueue for this contractID, and /remove uses that same eventqueue\n          sbp('chelonia/contract/remove', contractID).catch(e => {\n            console.error(`sideEffect(removeMember): ${e.name} thrown by /remove ${contractID}:`, e)\n          })\n          // this looks crazy, but doing this was necessary to fix a race condition in the\n          // group-member-removal Cypress tests where due to the ordering of asynchronous events\n          // we were getting the same latestHash upon re-logging in for test \"user2 rejoins groupA\".\n          // We add it to the same queue as '/remove' above gets run on so that it is run after\n          // contractID is removed. See also comments in 'gi.actions/identity/login'.\n          sbp('chelonia/queueInvocation', contractID, ['gi.actions/identity/saveOurLoginState'])\n            .then(function () {\n              const router = sbp('controller/router')\n              const switchFrom = router.currentRoute.path\n              const switchTo = groupIdToSwitch ? '/dashboard' : '/'\n              if (switchFrom !== '/join' && switchFrom !== switchTo) {\n                router.push({ path: switchTo }).catch(console.warn)\n              }\n            }).catch(e => {\n              console.error(`sideEffect(removeMember): ${e.name} thrown during queueEvent to ${contractID} by saveOurLoginState:`, e)\n            })\n          // TODO - #828 remove other group members contracts if applicable\n        } else {\n          const myProfile = getters.groupProfile(username)\n\n          if (isActionYoungerThanUser(meta, myProfile)) {\n            const memberRemovedThemselves = data.member === meta.username\n\n            sbp('gi.notifications/emit', // emit a notification for a member removal.\n              memberRemovedThemselves ? 'MEMBER_LEFT' : 'MEMBER_REMOVED',\n              {\n                groupID: contractID,\n                username: memberRemovedThemselves ? meta.username : data.member\n              })\n          }\n          // TODO - #828 remove the member contract if applicable.\n          // problem is, if they're in another group we're also a part of, or if we\n          // have a DM with them, we don't want to do this. may need to use manual reference counting\n          // sbp('chelonia/contract/release', getters.groupProfile(data.member).contractID)\n        }\n        // TODO - #850 verify open proposals and see if they need some re-adjustment.\n      }\n    },\n    'gi.contracts/group/removeOurselves': {\n      validate: objectMaybeOf({\n        reason: string\n      }),\n      process ({ data, meta, contractID }, { state, getters }) {\n        memberLeaves(\n          { username: meta.username, dateLeft: meta.createdDate },\n          { meta, state, getters }\n        )\n\n        sbp('gi.contracts/group/pushSideEffect', contractID,\n          ['gi.contracts/group/removeMember/sideEffect', {\n            meta,\n            data: { member: meta.username, reason: data.reason || '' },\n            contractID\n          }]\n        )\n      }\n    },\n    'gi.contracts/group/invite': {\n      validate: inviteType,\n      process ({ data, meta }, { state }) {\n        Vue.set(state.invites, data.inviteSecret, data)\n      }\n    },\n    'gi.contracts/group/inviteAccept': {\n      validate: objectOf({\n        inviteSecret: string // NOTE: simulate the OP_KEY_* stuff for now\n      }),\n      process ({ data, meta }, { state }) {\n        console.debug('inviteAccept:', data, state.invites)\n        const invite = state.invites[data.inviteSecret]\n        if (invite.status !== INVITE_STATUS.VALID) {\n          console.error(`inviteAccept: invite for ${meta.username} is: ${invite.status}`)\n          return\n        }\n        Vue.set(invite.responses, meta.username, true)\n        if (Object.keys(invite.responses).length === invite.quantity) {\n          invite.status = INVITE_STATUS.USED\n        }\n        // TODO: ensure `meta.username` is unique for the lifetime of the username\n        //       since we are making it possible for the same username to leave and\n        //       rejoin the group. All of their past posts will be re-associated with\n        //       them upon re-joining.\n        Vue.set(state.profiles, meta.username, initGroupProfile(meta.identityContractID, meta.createdDate))\n        // If we're triggered by handleEvent in state.js (and not latestContractState)\n        // then the asynchronous sideEffect function will get called next\n        // and we will subscribe to this new user's identity contract\n      },\n      // !! IMPORANT!!\n      // Actions here MUST NOT modify contract state!\n      // They MUST NOT call 'commit'!\n      // They should only coordinate the actions of outside contracts.\n      // Otherwise `latestContractState` and `handleEvent` will not produce same state!\n      async sideEffect ({ meta, contractID }, { state }) {\n        const { loggedIn } = sbp('state/vuex/state')\n        const { profiles = {} } = state\n\n        // TODO: per #257 this will ,have to be encompassed in a recoverable transaction\n        // however per #610 that might be handled in handleEvent (?), or per #356 might not be needed\n        if (meta.username === loggedIn.username) {\n          // we're the person who just accepted the group invite\n          // so subscribe to founder's IdentityContract & everyone else's\n          for (const name in profiles) {\n            if (name !== loggedIn.username) {\n              await sbp('chelonia/contract/sync', profiles[name].contractID)\n            }\n          }\n        } else {\n          const myProfile = profiles[loggedIn.username]\n          // we're an existing member of the group getting notified that a\n          // new member has joined, so subscribe to their identity contract\n          await sbp('chelonia/contract/sync', meta.identityContractID)\n\n          if (isActionYoungerThanUser(meta, myProfile)) {\n            sbp('gi.notifications/emit', 'MEMBER_ADDED', { // emit a notification for a member addition.\n              groupID: contractID,\n              username: meta.username\n            })\n          }\n        }\n      }\n    },\n    'gi.contracts/group/inviteRevoke': {\n      validate: (data, { state, meta }) => {\n        objectOf({\n          inviteSecret: string // NOTE: simulate the OP_KEY_* stuff for now\n        })(data)\n\n        if (!state.invites[data.inviteSecret]) {\n          throw new TypeError(L('The link does not exist.'))\n        }\n      },\n      process ({ data, meta }, { state }) {\n        const invite = state.invites[data.inviteSecret]\n        Vue.set(invite, 'status', INVITE_STATUS.REVOKED)\n      }\n    },\n    'gi.contracts/group/updateSettings': {\n      // OPTIMIZE: Make this custom validation function\n      // reusable accross other future validators\n      validate: objectMaybeOf({\n        groupName: x => typeof x === 'string',\n        groupPicture: x => typeof x === 'string',\n        sharedValues: x => typeof x === 'string',\n        mincomeAmount: x => typeof x === 'number' && x > 0,\n        mincomeCurrency: x => typeof x === 'string'\n      }),\n      process ({ meta, data }, { state }) {\n        for (const key in data) {\n          Vue.set(state.settings, key, data[key])\n        }\n      }\n    },\n    'gi.contracts/group/groupProfileUpdate': {\n      validate: objectMaybeOf({\n        incomeDetailsType: x => ['incomeAmount', 'pledgeAmount'].includes(x),\n        incomeAmount: x => typeof x === 'number' && x >= 0,\n        pledgeAmount: x => typeof x === 'number' && x >= 0,\n        nonMonetaryAdd: string,\n        nonMonetaryEdit: objectOf({\n          replace: string,\n          with: string\n        }),\n        nonMonetaryRemove: string,\n        paymentMethods: arrayOf(\n          objectOf({\n            name: string,\n            value: string\n          })\n        )\n      }),\n      process ({ data, meta }, { state, getters }) {\n        const groupProfile = state.profiles[meta.username]\n        const nonMonetary = groupProfile.nonMonetaryContributions\n        for (const key in data) {\n          const value = data[key]\n          switch (key) {\n            case 'nonMonetaryAdd':\n              nonMonetary.push(value)\n              break\n            case 'nonMonetaryRemove':\n              nonMonetary.splice(nonMonetary.indexOf(value), 1)\n              break\n            case 'nonMonetaryEdit':\n              nonMonetary.splice(nonMonetary.indexOf(value.replace), 1, value.with)\n              break\n            default:\n              Vue.set(groupProfile, key, value)\n          }\n        }\n        if (data.incomeDetailsType) {\n          // someone updated their income details, create a snapshot of the haveNeeds\n          updateCurrentDistribution({ meta, state, getters })\n        }\n      }\n    },\n    'gi.contracts/group/updateAllVotingRules': {\n      validate: objectMaybeOf({\n        ruleName: x => [RULE_PERCENTAGE, RULE_DISAGREEMENT].includes(x),\n        ruleThreshold: number,\n        expires_ms: number\n      }),\n      process ({ data, meta }, { state }) {\n        // Update all types of proposal settings for simplicity\n        if (data.ruleName && data.ruleThreshold) {\n          for (const proposalSettings in state.settings.proposals) {\n            Vue.set(state.settings.proposals[proposalSettings], 'rule', data.ruleName)\n            Vue.set(state.settings.proposals[proposalSettings].ruleSettings[data.ruleName], 'threshold', data.ruleThreshold)\n          }\n        }\n\n        // TODO later - support update expires_ms\n        // if (data.ruleName && data.expires_ms) {\n        //   for (const proposalSetting in state.settings.proposals) {\n        //     Vue.set(state.settings.proposals[proposalSetting].ruleSettings[data.ruleName], 'expires_ms', data.expires_ms)\n        //   }\n        // }\n      }\n    },\n    'gi.contracts/group/addChatRoom': {\n      validate: objectOf({\n        chatRoomID: string,\n        attributes: chatRoomAttributesType\n      }),\n      process ({ data, meta }, { state }) {\n        const { name, type, privacyLevel } = data.attributes\n        Vue.set(state.chatRooms, data.chatRoomID, {\n          creator: meta.username,\n          name,\n          type,\n          privacyLevel,\n          deletedDate: null,\n          users: []\n        })\n        if (!state.generalChatRoomId) {\n          Vue.set(state, 'generalChatRoomId', data.chatRoomID)\n        }\n      }\n    },\n    'gi.contracts/group/deleteChatRoom': {\n      validate: (data, { getters, meta }) => {\n        objectOf({ chatRoomID: string })(data)\n\n        if (getters.getChatRooms[data.chatRoomID].creator !== meta.username) {\n          throw new TypeError(L('Only the channel creator can delete channel.'))\n        }\n      },\n      process ({ data, meta }, { state }) {\n        Vue.delete(state.chatRooms, data.chatRoomID)\n      }\n    },\n    'gi.contracts/group/leaveChatRoom': {\n      validate: objectOf({\n        chatRoomID: string,\n        member: string,\n        leavingGroup: boolean // if kicker is exists, it means group leaving\n      }),\n      process ({ data, meta }, { state }) {\n        Vue.set(state.chatRooms[data.chatRoomID], 'users',\n          state.chatRooms[data.chatRoomID].users.filter(u => u !== data.member))\n      },\n      async sideEffect ({ meta, data }, { state }) {\n        const rootState = sbp('state/vuex/state')\n        if (meta.username === rootState.loggedIn.username && !sbp('okTurtles.data/get', 'JOINING_GROUP')) {\n          const sendingData = data.leavingGroup\n            ? { member: data.member }\n            : { member: data.member, username: meta.username }\n          await sbp('gi.actions/chatroom/leave', { contractID: data.chatRoomID, data: sendingData })\n        }\n      }\n    },\n    'gi.contracts/group/joinChatRoom': {\n      validate: objectMaybeOf({\n        username: string,\n        chatRoomID: string\n      }),\n      process ({ data, meta }, { state }) {\n        const username = data.username || meta.username\n        state.chatRooms[data.chatRoomID].users.push(username)\n      },\n      async sideEffect ({ meta, data }, { state }) {\n        const rootState = sbp('state/vuex/state')\n        const username = data.username || meta.username\n        if (username === rootState.loggedIn.username) {\n          if (!sbp('okTurtles.data/get', 'JOINING_GROUP') || sbp('okTurtles.data/get', 'READY_TO_JOIN_CHATROOM')) {\n            // while users are joining chatroom, they don't need to leave chatrooms\n            // this is similar to setting 'JOINING_GROUP' before joining group\n            sbp('okTurtles.data/set', 'JOINING_CHATROOM_ID', data.chatRoomID)\n            await sbp('chelonia/contract/sync', data.chatRoomID)\n            sbp('okTurtles.data/set', 'JOINING_CHATROOM_ID', undefined)\n            sbp('okTurtles.data/set', 'READY_TO_JOIN_CHATROOM', false)\n          }\n        }\n      }\n    },\n    'gi.contracts/group/renameChatRoom': {\n      validate: objectOf({\n        chatRoomID: string,\n        name: string\n      }),\n      process ({ data, meta }, { state, getters }) {\n        Vue.set(state.chatRooms, data.chatRoomID, {\n          ...getters.getChatRooms[data.chatRoomID],\n          name: data.name\n        })\n      }\n    },\n    ...((process.env.NODE_ENV === 'development' || process.env.CI) && {\n      'gi.contracts/group/forceDistributionDate': {\n        validate: optional,\n        process ({ meta }, { state, getters }) {\n          getters.groupSettings.distributionDate = dateToPeriodStamp(meta.createdDate)\n        }\n      },\n      'gi.contracts/group/malformedMutation': {\n        validate: objectOf({ errorType: string, sideEffect: optional(boolean) }),\n        process ({ data }) {\n          const ErrorType = Errors[data.errorType]\n          if (data.sideEffect) return\n          if (ErrorType) {\n            throw new ErrorType('malformedMutation!')\n          } else {\n            throw new Error(`unknown error type: ${data.errorType}`)\n          }\n        },\n        sideEffect (message, { state }) {\n          if (!message.data.sideEffect) return\n          sbp('gi.contracts/group/malformedMutation/process', {\n            ...message,\n            data: omit(message.data, ['sideEffect'])\n          }, state)\n        }\n      }\n    })\n    // TODO: remove group profile when leave group is implemented\n  },\n  // methods are SBP selectors that are version-tracked for each contract.\n  // in other words, you can use them to define SBP selectors that will\n  // contain functions that you can modify across different contract versions,\n  // and when the contract calls them, it will use that specific version of the\n  // method.\n  //\n  // They are useful when used in conjunction with pushSideEffect from process\n  // functions.\n  //\n  // IMPORTANT: they MUST begin with the name of the contract.\n  methods: {\n    'gi.contracts/group/archiveProposal': async function (contractID, proposalHash, proposal) {\n      const { username } = sbp('state/vuex/state').loggedIn\n      const key = `proposals/${username}/${contractID}`\n      const proposals = await sbp('gi.db/archive/load', key) || []\n      // newest at the front of the array, oldest at the back\n      proposals.unshift([proposalHash, proposal])\n      while (proposals.length > MAX_ARCHIVED_PROPOSALS) {\n        proposals.pop()\n      }\n      await sbp('gi.db/archive/save', key, proposals)\n      sbp('okTurtles.events/emit', PROPOSAL_ARCHIVED, [proposalHash, proposal])\n    }\n  }\n})\n"],
  "mappings": "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",
  "names": []
}
